

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>operational_sep_quantities module &mdash; operational_sep_quantities 3.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="read_datasets module" href="read_datasets.html" />
    <link rel="prev" title="operational-sep all modules" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> operational_sep_quantities
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="repository.html">Repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="overall_description.html">Overall Description</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">operational-sep all modules</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">operational_sep_quantities module</a></li>
<li class="toctree-l2"><a class="reference internal" href="read_datasets.html">read_datasets module</a></li>
<li class="toctree-l2"><a class="reference internal" href="global_vars.html">global_vars module</a></li>
<li class="toctree-l2"><a class="reference internal" href="derive_background.html">derive_background module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ccmc_json_handler.html">ccmc_json_handler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="keys.html">keys module</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_multi_sep.html">run_multi_sep module</a></li>
<li class="toctree-l2"><a class="reference internal" href="compare_data_model.html">compare_data_model module</a></li>
<li class="toctree-l2"><a class="reference internal" href="read_json_example.html">read_json_example module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">operational_sep_quantities</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">operational-sep all modules</a> &raquo;</li>
        
      <li>operational_sep_quantities module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/operational_sep_quantities.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-operational_sep_quantities">
<span id="operational-sep-quantities-module"></span><h1>operational_sep_quantities module<a class="headerlink" href="#module-operational_sep_quantities" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.all_program_info">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">all_program_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.all_program_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Program description for operational_sep_quantities.py v3.2.</p>
<p>Formatting for Sphinx web-based documentation, which can be viewed
within the docs/index.html directory or online at:
<a class="reference external" href="https://ktindiana.github.io/operational-sep/index.html">https://ktindiana.github.io/operational-sep/index.html</a></p>
<p>This program will calculate various useful pieces of operational
information about SEP events from GOES-08, -10, -11, -12, -13, -14, -15
data and the SEPEM (RSDv2 and RSDv3) dataset.</p>
<p>SEP event values are always calculated for threshold definitions:</p>
<blockquote>
<div><ul class="simple">
<li><p>&gt;10 MeV exceeds 10 pfu</p></li>
<li><p>&gt;100 MeV exceed 1 pfu</p></li>
</ul>
</div></blockquote>
<p>The user may add multiple additional thresholds through the command line.
This program will check if data is already present in a ‘data’ directory. If
not, GOES or EPHIN data will be automatically downloaded from the web. SEPEM
(RSDv2 and RSDv3) data must be downloaded by the user and unzipped inside
the ‘data’ directory. Because the SEPEM data set is so large (every 5
minutes from 1974 to 2015 for RSDv2 and to 2017 for RSDv3), the program will
break up the data into yearly files for faster reading.</p>
<p>–NoInterp: Data sets are checked for bad data point (negative or None value
fluxes) and the default behavior is to fill in those bad data points by
performing a linear interpolation with time. This choice was made to
calculate more accurate event-intergrated fluence values from data.
Interpolation with time is not appropriate for model predictions, as
it will inherently change the prediction or may not be desired by
the user for the data set. Turn off interpolation with time by
setting the –NoInterp flag (or nointerp=True). If the interpolation
is turned off, negative flux values will be set to None.
Zeroes are always treated as valid values and are not replaced.
If there are gaps in the time steps, the code does NOT try to
fill in the gaps. It will ONLY perform interpolation for time
steps present in the input data set. i.e. gaps in time are not
interpolated, only time steps with negative or None flux values.</p>
<p>The values calculated here are important for space radiation operations:</p>
<blockquote>
<div><ul class="simple">
<li><p>Onset time, i.e. time to cross thresholds</p></li>
<li><p>Onset peak intensity</p></li>
<li><p>Onset peak time</p></li>
<li><p>Maximum intensity</p></li>
<li><p>Time of maximum intensity</p></li>
<li><p>Rise time (onset to peak)</p></li>
<li><p>End time, i.e. fall below 0.85*threshold for 3 points (15 mins for GOES)</p></li>
<li><p>Duration</p></li>
<li><p>Event-integrated fluences</p></li>
<li><p>Proton fluxes at various times after threshold crossing (UMASEP option)</p></li>
</ul>
</div></blockquote>
<p>UNITS: User may choose differential proton fluxes (e.g. [MeV s sr cm^2]^-1)
or integral fluxes (e.g. [s sr cm^2]^-1 or pfu). Default units are:
MeV, cm, s, sr
Units are specified in library/global_vars.py.
The program has no internal checks or requirements on units - EXCEPT FOR
THE THRESHOLD DEFINITIONS OF &gt;10, 10 and &gt;100, 1.
If you convert those thresholds in the main program to your units,
you should be able to generate consistent results.
Currently there are no features to change units automatically. SEE MORE
about units in the USER INPUT DATA section below.</p>
<p>OPTIONS: User may specify various options, that currently only apply to
GOES data:</p>
<blockquote>
<div><ul class="simple">
<li><p>Choose corrected or uncorrected GOES fluxes.</p></li>
<li><p>Choose to apply Bruno (2017) or Sandberg et al. (2014) effective
energies to GOES uncorrected data.</p></li>
</ul>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">options</span> <span class="n">uncorrected</span>
<span class="o">--</span><span class="n">options</span> <span class="n">uncorrected</span><span class="p">,</span><span class="n">S14</span><span class="p">,</span><span class="n">Bruno2017</span> <span class="p">(</span><span class="n">recommend</span> <span class="n">using</span> <span class="n">background</span> <span class="n">subtraction</span><span class="p">)</span>
</pre></div>
</div>
<p>BACKGROUND SUBTRACTION: Users may choose to perform a background
subtraction by specifying:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">SubtractBG</span> <span class="o">--</span><span class="n">BGStartDate</span> <span class="n">YYYY</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">DD</span> <span class="o">--</span><span class="n">BGEndDate</span> <span class="n">YYYY</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">DD</span>
</pre></div>
</div>
<p>The user should look at the data and select an appropriate time frame
prior to the event when the background is calm and well-defined. If
performing background subtraction, the mean background will be subtracted
from the fluxes in the SEP time frame (StartDate to EndDate). Plots
showing the mean background level, the background flux only, and the
background-subtracted SEP fluxes will be created by derive_background to
verify the quality of the background estimation and subtraction.</p>
<p>If a previous event is ongoing and the specified time period starts with a
threshold already crossed, you may try to set the –DetectPreviousEvent
flag. If the flux drops below threshold before the next event starts, the
program will identify the second event. This will only work if the
threshold is already crossed for the very first time in your specified
time period, and if the flux drops below threshold before the next event
starts.</p>
<p>If the event has an initial increase above threshold for a few points, falls
below threshold, then continues to increase above threshold again, you
may try to use the –TwoPeak feature to capture the full duration of the
event. The initial increase above threshold must be less than a day. An
example of this scenario can be seen in &gt;100 MeV for 2011-08-04.</p>
<p>A flag was added with the “UMASEP” option. When this flag is used
(–UMASEP), the code finds all information for four energy channels and
thresholds used by UMASEP: &gt;10 MeV, 10 pfu; &gt;100 MeV, 1 pfu; &gt;30 MeV, 1 pfu;
&gt;50 MeV, 1 pfu. The proton flux in each of these channels is reported for
multiple times after threshold crossing (Ts). The applied time delays are
as follows:</p>
<blockquote>
<div><ul class="simple">
<li><p>&gt;10 MeV - Ts + 3, 4, 5, 6, 7 hours</p></li>
<li><p>&gt;30 MeV - Ts + 3, 4, 5, 6, 7 hours</p></li>
<li><p>&gt;50 MeV - Ts + 3, 4, 5, 6, 7 hours</p></li>
<li><p>&gt;100 MeV - Ts + 3, 4, 5, 6, 7 hours</p></li>
</ul>
</div></blockquote>
<p>–spase_id: If you know the appropriate spase_id for the your model or
experiment, you may specify it here to be filled in to the json file
for CCMC’s SEP Scoreboard.</p>
<p>Note about EVENT END TIME: Currently, the code calculates the end of the
event as the first time that the flux drops below threshold*endfac for
three consecutive points. The endfac variable is specified in
library/global_vars.py.
Mimicking a SRAG code, endfac is set to 0.85 (85% of threshold). This
may be changed in the future to update this to more NOAA SWPC-like logic
to define the end of an SEP event.</p>
<blockquote>
<div><p>Note about ONSET PEAK: In operational_sep_quantities.py version 3.0,</p>
</div></blockquote>
<p>the onset peak may be found up to 12 hours prior to the threshold crossing
that determines the SEP event start time. In previous versions, the onset
peak could only be found at or after the threshold crossing time. For events
that crossed threshold by a small amount, this often meant that the
actual onset peak as identified by eye occurred prior to threshold crossing
at a lower flux value. In an effort to derive the onset peak from the shape
of the flux time profile independent of the applied threshold value, the code
will search for the onset peak 12 hours earlier for events with lower
flux levels. The documentation for
operational_sep_quantities.calculate_onset_peak() has further details.</p>
<p>RUN CODE FROM COMMAND LINE (put on one line), e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">operational_sep_quantities</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">StartDate</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">17</span>
<span class="o">--</span><span class="n">EndDate</span> <span class="s2">&quot;2012-05-19 12:00:00&quot;</span> <span class="o">--</span><span class="n">Experiment</span> <span class="n">GOES</span><span class="o">-</span><span class="mi">13</span>
<span class="o">--</span><span class="n">FluxType</span> <span class="n">integral</span> <span class="o">--</span><span class="n">showplot</span> <span class="o">--</span><span class="n">saveplot</span>
</pre></div>
</div>
<p>RUN CODE FROM COMMAND FOR USER DATA SET (put on one line), e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">operational_sep_quantities</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">StartDate</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">17</span>
<span class="o">--</span><span class="n">EndDate</span> <span class="s1">&#39;2012-05-19 12:00:00&#39;</span> <span class="o">--</span><span class="n">Experiment</span> <span class="n">user</span> <span class="o">--</span><span class="n">ModelName</span> <span class="n">MyModel</span>
<span class="o">--</span><span class="n">UserFile</span> <span class="n">MyFluxes</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">FluxType</span> <span class="n">integral</span> <span class="o">--</span><span class="n">showplot</span>
</pre></div>
</div>
<p>RUN CODE FROM COMMAND LINE AND PERFORM BACKGROUND SUBTRACTION AND APPLY
Sandberg et al. (2014) and Bruno (2017) effective energies to the GOES bins.
(note: cannot bg-subtract GOES integral fluxes), e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">operational_sep_quantities</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">StartDate</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">17</span>
<span class="o">--</span><span class="n">EndDate</span> <span class="s1">&#39;2012-05-19 12:00:00&#39;</span> <span class="o">--</span><span class="n">Experiment</span> <span class="n">GOES</span><span class="o">-</span><span class="mi">13</span>
<span class="o">--</span><span class="n">FluxType</span> <span class="n">differential</span>  <span class="o">--</span><span class="n">showplot</span> <span class="o">--</span><span class="n">options</span> <span class="n">uncorrected</span><span class="p">,</span><span class="n">S14</span><span class="p">,</span><span class="n">Bruno2017</span>
<span class="o">--</span><span class="n">SubtractBG</span> <span class="o">--</span><span class="n">BGStartDate</span> <span class="mi">2012</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">10</span> <span class="o">--</span><span class="n">BGEndDate</span> <span class="o">--</span><span class="mi">2012</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">17</span>
</pre></div>
</div>
<p>RUN CODE IMPORTED INTO ANOTHER PYTHON PROGRAM, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">operational_sep_quantities</span> <span class="k">as</span> <span class="nn">sep</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="s1">&#39;2012-05-17&#39;</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="s1">&#39;2012-05-19 12:00:00&#39;</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="s1">&#39;GOES-13&#39;</span>
<span class="n">flux_type</span> <span class="o">=</span> <span class="s1">&#39;integral&#39;</span>
<span class="n">spase_id</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="c1">#if experiment is user, set model_name to describe data set</span>
<span class="n">user_file</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="c1">#if experiment is user, specify filename containing fluxes</span>
<span class="n">json_type</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="c1">#if experiment is user, specify which type of json file</span>
               <span class="c1"># should be created</span>
<span class="n">showplot</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1">#Turn to False if don&#39;t want to see plots</span>
<span class="n">saveplot</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">#turn to true if you want to save plots to file</span>
<span class="n">options</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="c1">#various options: S14, Bruno2017, uncorrected</span>
<span class="n">doBGSub</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">#Set true if want to perform background subtraction</span>
<span class="n">bgstart_date</span> <span class="o">=</span> <span class="s2">&quot;2012-05-10&quot;</span> <span class="c1">#Dates used to estimate mean background if</span>
<span class="n">bgend_date</span> <span class="o">=</span> <span class="s2">&quot;2012-05-17&quot;</span>   <span class="c1">#doBGSub is set to True</span>
<span class="n">detect_prev_event</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1">#Helps if previous event causes high intensities</span>
<span class="n">two_peaks</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1">#Helps if two increases above threshold in one event</span>
<span class="n">umasep</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">#Set to true if want UMASEP values (see explanation above)</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="c1">#Add a threshold to 10,10 and 100,1: &#39;30,1&#39; or &#39;4.9-7.3,0.01&#39;</span>
<span class="n">nointerp</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">#Default False; set to True to stop linear interpolatin in time</span>

<span class="n">sep_year</span><span class="p">,</span> <span class="n">sep_month</span><span class="p">,</span><span class="n">sep_day</span><span class="p">,</span> <span class="n">jsonfname</span> <span class="o">=</span> <span class="n">sep</span><span class="o">.</span><span class="n">run_all</span><span class="p">(</span><span class="n">start_date</span><span class="p">,</span>             <span class="n">end_date</span><span class="p">,</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">flux_type</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">user_file</span><span class="p">,</span> <span class="n">json_type</span><span class="p">,</span>            <span class="n">spase_id</span><span class="p">,</span> <span class="n">showplot</span><span class="p">,</span> <span class="n">saveplot</span><span class="p">,</span> <span class="n">detect_prev_event</span><span class="p">,</span>              <span class="n">two_peaks</span><span class="p">,</span> <span class="n">umasep</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">doBGSub</span><span class="p">,</span> <span class="n">bgstart_date</span><span class="p">,</span>             <span class="n">bgend_date</span><span class="p">,</span><span class="n">nointerp</span><span class="p">)</span>
</pre></div>
</div>
<p>Set the desired directory locations for the data and output at the beginning
of the program in datapath and outpath. Defaults are ‘data’ and ‘output’.</p>
<p>In order to calculate the fluence, the program determines time_resolution
(seconds) by finding the difference between every consecutive set of
time points in the data set. The most common difference is identified as
the time resolution. This method should find an accurate time resolution
even if there are gaps in the time steps.
If the time steps in the data set are truly irregular, the user will
have to manually set the time resolution inside the subroutine
calculate_fluence.</p>
<p>OUTPUT: This program outputs 3 to 4 files, 1 per defined threshold plus
a summary file containing all of the values calculated for each threshold.
A file named as e.g. fluence_GOES-13_differential_gt10_2012_3_7.csv contains
the event-integrated fluence for each energy channel using the specified
threshold (gt10) to determine start and stop times.
A file named as e.g. sep_values_GOES-13_differential_2012_3_7.csv contains
start time, peak flux, etc, for each of the defined thresholds.</p>
<p>The program write to file the &gt;10 MeV and &gt;100 MeV time series for the
date range input by the user. If the original data were integral fluxes,
then the output files simply contain the &gt;10 and &gt;100 MeV time series from
the input files. If the original data were differential fluxes, then the
estimated &gt;10 and &gt;100 MeV fluxes are output as time series.</p>
<p>The program also writes any time profile to file if a threshold was applied
to it. Each energy channel is written to an independent file, named according
to CCMC’s SEP Scoreboard naming conventions. These accompany a json file
that contains all quantities calculated for the SEP event. There is also a csv
file that contains most of the same values recorded in the json file.</p>
<p>Example output for values derived from SEPMOD forecasts for the 2021-05-29
SEP event with additional threshold &gt;10, 0.001 pfu, &gt;100, 0.0001 pfu,
&gt;30 MeV, 1 pfu, &gt;50 MeV, 1 pfu, and &gt;60 MeV, 0.079 pfu. Some of the files
below are only created if a threshold was crossed. A default run would produce
only 10 and 100 MeV files, sep_values_*.csv and json file:</p>
<ul class="simple">
<li><p>fluence_SEPMOD_RT_60min_integral_gt10_2021_5_29.csv</p></li>
<li><p>fluence_SEPMOD_RT_60min_integral_gt10.0_2021_5_29.csv</p></li>
<li><p>fluence_SEPMOD_RT_60min_integral_gt30.0_2021_5_29.csv</p></li>
<li><p>fluence_SEPMOD_RT_60min_integral_gt50.0_2021_5_29.csv</p></li>
<li><p>fluence_SEPMOD_RT_60min_integral_gt60.0_2021_5_29.csv</p></li>
<li><p>fluence_SEPMOD_RT_60min_integral_gt100.0_2021_5_29.csv</p></li>
<li><p>integral_fluxes_SEPMOD_RT_60min_integral_2021_5_29.csv</p></li>
<li><p>sep_values_SEPMOD_RT_60min_integral_2021_5_29.csv</p></li>
<li><p>SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.10.0MeV.txt</p></li>
<li><p>SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.10MeV.txt</p></li>
<li><p>SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.30.0MeV.txt</p></li>
<li><p>SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.50.0MeV.txt</p></li>
<li><p>SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.60.0MeV.txt</p></li>
<li><p>SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.100.0MeV.txt</p></li>
<li><p>SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.100MeV.txt</p></li>
<li><p>SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.json</p></li>
</ul>
<p>The json and txt files listed above would be the ones that would be appropriate
to read into the CCMC SEP Scoreboard or to pass to the SEP validation code
being developed in conjunction with the SEP Scoreboard. The csv files are legacy
files, but may also be easier for some users to read.</p>
<p>USER INPUT DATA SETS: Users may input their own data set. For example, if an
SEP modeler would like to feed their own intensity time series into this
code and calculate all values in exactly the same way they were calculated
for data, it is possible to do that. Default flux units are
1/[MeV cm^2 s sr] or 1/[cm^2 s sr] and energy channels in MeV for the default
thresholds to be correct. You can specify your units in the
library/global_vars.py file.</p>
<p>You can use any units, as long as you are consistent with energy units in
energy channel/bin definition and in fluxes and you MODIFY THE THRESHOLD
VALUES TO REFLECT YOUR UNITS. If you want to use different units, but
still have the correct operational definitions, you need to modify these
lines in define_thresholds() below:</p>
<blockquote>
<div><ul class="simple">
<li><p>energy_thresholds = [10,100] #MeV; flux for particles of &gt; this MeV</p></li>
<li><p>flux_thresholds = [10,1] #pfu; exceed this level of intensity</p></li>
</ul>
</div></blockquote>
<p>NOTE: The first column in your flux file is assumed to be time in format
YYYY-MM-DD HH:MM:SS. IMPORTANT FORMATTING!!
NOTE: The flux file may contain header lines that start with a hash #,
including blank lines.
NOTE: Any bad or missing fluxes must be indicated by a negative value.
NOTE: Put your flux file into the “datapath” directory. Filenames will be
relative to this path.
NOTE: Please use only differential or integral channels. Please do not mix
them. You may have one integral channel in the last bin, as this is the way
HEPAD works and the code has been written to include that HEPAD &gt;700 MeV
bin along with lower differential channels.
NOTE: You must specify whether your input file represents model output or
observations so that the correct type of JSON file may be written. Use the
JSONType flag or json_type variable and specify “model” or “observations”
to indicate which is the correct format. The default is set to “model”
when run from main.</p>
<p>USER VARIABLES: The user must modify the following variables in
library/global_vars.py:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">user_col</dt>
<dd class="field-odd"><p>identify columns in your file containing fluxes to analyze;
even if your delimeter is white space, consider the date-time
column as one single column. SET IN library/global_vars.py.</p>
</dd>
<dt class="field-even">user_delim</dt>
<dd class="field-even"><p>delimeter between columns, e.g. ” ” or “,”   Use ” ” for
any amount of whitespace. SET IN library/global_vars.py.</p>
</dd>
<dt class="field-odd">user_energy_bins</dt>
<dd class="field-odd"><p>define your energy bins at the top of the code in the
variable user_energy_bins. Follow the format in the subroutine
define_energy_bins. SET IN library/global_vars.py.</p>
</dd>
<dt class="field-even">user_fname</dt>
<dd class="field-even"><p>specify the name of the file containing the fluxes
through an argument in the command line. –UserFile  The
user_fname variable will be updated with that filename. ARGUMENT</p>
</dd>
<dt class="field-odd">time_resolution</dt>
<dd class="field-odd"><p>the program determines time_resolution
(seconds) by finding the difference between every consecutive
set of time points in the data set. The most common difference
is identified as the time resolution. This method should find
an accurate time resolution even if there are gaps in the
time steps.. AUTOMATICALLY DETERMINED.</p>
</dd>
</dl>
</div></blockquote>
<p>Running the code for a user-input file may look like the example below.
Note that the –UserFile location is with respect to the “data” directory
inside the operational-sep directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">operational_sep_quantities</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">StartDate</span> <span class="mi">2021</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">29</span> <span class="o">--</span><span class="n">EndDate</span> <span class="mi">2021</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">05</span> <span class="o">--</span><span class="n">Experiment</span> <span class="n">user</span> <span class="o">--</span><span class="n">UserFile</span> <span class="n">SEPMOD</span><span class="o">/</span><span class="n">Scoreboard</span><span class="o">/</span><span class="n">SEPMOD</span><span class="mf">.20210529_000000.20210529_165133.20210529_133005</span><span class="n">_geo_integral_tseries_timestamped_60min</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">ModelName</span> <span class="n">SEPMOD_RT_60min</span> <span class="o">--</span><span class="n">JSONType</span> <span class="n">model</span> <span class="o">--</span><span class="n">showplot</span> <span class="o">--</span><span class="n">Threshold</span> <span class="s2">&quot;10,0.001;100,0.0001;30,1;50,1;60,0.079&quot;</span> <span class="o">--</span><span class="n">spase_id</span> <span class="s2">&quot;spase://CCMC/SimulationModel/SEPMOD&quot;</span> <span class="o">--</span><span class="n">FluxType</span> <span class="n">integral</span>
</pre></div>
</div>
<p>VALUES SPECIFIED IN library/global_vars.py:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">datapath</dt>
<dd class="field-odd"><p>directory containing data, ‘data’</p>
</dd>
<dt class="field-even">outpath</dt>
<dd class="field-even"><p>directory for program output, ‘output’</p>
</dd>
<dt class="field-odd">plotpath</dt>
<dd class="field-odd"><p>directory for saving plots, ‘plots’</p>
</dd>
<dt class="field-even">listpath</dt>
<dd class="field-even"><p>directory for lists (for run_multi_sep.py)</p>
</dd>
<dt class="field-odd">badval</dt>
<dd class="field-odd"><p>will set any bad data points to this value</p>
</dd>
<dt class="field-even">endfac</dt>
<dd class="field-even"><p>multiplicative factor to define threshold for
end of event; threshold*endfac (default 0.85)</p>
</dd>
<dt class="field-odd">nsigma</dt>
<dd class="field-odd"><p>number of sigma to define SEP versus background
flux in background subtraction routine</p>
</dd>
<dt class="field-even">version</dt>
<dd class="field-even"><p>if you are running a model or data set, allows you
to enter a version number</p>
</dd>
<dt class="field-odd">user_col</dt>
<dd class="field-odd"><p>array defining flux columns (0 is always datetime)</p>
</dd>
<dt class="field-even">user_delim</dt>
<dd class="field-even"><p>delimeter used to separate the columns in the time
profile file that you will read in</p>
</dd>
<dt class="field-odd">user_energy_bins</dt>
<dd class="field-odd"><p>energy bins associated with the columns
specified in user_col</p>
</dd>
<dt class="field-even">energy_units</dt>
<dd class="field-even"><p>e.g. “MeV’</p>
</dd>
<dt class="field-odd">flux_units_integral</dt>
<dd class="field-odd"><p>e.g. “pfu”</p>
</dd>
<dt class="field-even">fluence_units_integral</dt>
<dd class="field-even"><p>e.g. “cm^-2”</p>
</dd>
<dt class="field-odd">flux_units_differential</dt>
<dd class="field-odd"><p>e.g. “MeV^-1*cm^-2*s^-1*sr^-1” (CCMC format)</p>
</dd>
<dt class="field-even">fluence_units_differential</dt>
<dd class="field-even"><p>e.g. “MeV^-1*cm^-2” (CCMC format)</p>
</dd>
</dl>
<p>(setting the units here will make correct units on plots and in json
file, but doesn’t change operational threshold values; must be done
accordingly by hand)</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.append_differential_thresholds">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">append_differential_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_diff_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plt_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plt_flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detect_prev_event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_threshold_fluences</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_fluence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rise_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_peak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_fluxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.append_differential_thresholds" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the threshold crossing information for differential channels
as specified by the user.</p>
<p>Definitions:</p>
<ul class="simple">
<li><p>n integral energy thresholds (&gt;10, &gt;100 + user input integral thresholds)</p></li>
<li><p>m energy bins associated with the input flux files</p></li>
<li><p>p user input thresholds (integral + differential, define d differential channels for which a threshold is applied n-2 = integral channels, (n-2)+d = p)</p></li>
<li><p>q time points in the flux time profiles (between user input start and end dates)</p></li>
</ul>
<p>INPUTS (filled in up to thresholds applied to integral channels):</p>
<dl class="field-list simple">
<dt class="field-odd">Energy_thresholds</dt>
<dd class="field-odd"><p>(float 1xn array) - energy channels for which a
threshold is applied (at this point, only the integral ones)</p>
</dd>
<dt class="field-even">Flux_thresholds</dt>
<dd class="field-even"><p>(float 1xn array) - flux thresholds applied to
the energy channels in energy_thresholds</p>
</dd>
<dt class="field-odd">Str_thresh</dt>
<dd class="field-odd"><p>(string 1xp array) - p user input thresholds broken into
an array (need for generating plot labels)</p>
</dd>
<dt class="field-even">Is_diff_thresh</dt>
<dd class="field-even"><p>(bool 1xp array) - indicates which of the user
thresholds are applied to differential channels</p>
</dd>
<dt class="field-odd">Plt_energy</dt>
<dd class="field-odd"><p>(float 1xn array) - holds energy thresholds for the
integral channels at this point</p>
</dd>
<dt class="field-even">Plt_flux</dt>
<dd class="field-even"><p>(float 1xn array) - hold the flux thresholds for the
integral channels at this point</p>
</dd>
<dt class="field-odd">Input_threshold</dt>
<dd class="field-odd"><p>(float 2xp array) - p input thresholds in form
[binlowedge, flux threshold]</p>
</dd>
<dt class="field-even">Energy_bins</dt>
<dd class="field-even"><p>(float 2xm array) - m energy bins for each input
flux channel</p>
</dd>
<dt class="field-odd">Dates</dt>
<dd class="field-odd"><p>(datetime 1xq array) - q time points for the flux time profile</p>
</dd>
<dt class="field-even">Fluxes</dt>
<dd class="field-even"><p>(float mxq array) - flux time profiles for m energy bins and
q time points</p>
</dd>
<dt class="field-odd">Detect_prev_event</dt>
<dd class="field-odd"><p>(bool) - option for finding start of event</p>
</dd>
<dt class="field-even">Two_peaks</dt>
<dd class="field-even"><p>(bool) - option for extending event length</p>
</dd>
<dt class="field-odd">Umasep</dt>
<dd class="field-odd"><p>(boolean) - indicate if user called UMASEP flag</p>
</dd>
<dt class="field-even">Umasep_times</dt>
<dd class="field-even"><p>(datetime 5xn array) - times 3, 4, 5, 7, 9 hours after
crossing time for each applied threshold</p>
</dd>
<dt class="field-odd">Umasep_fluxes</dt>
<dd class="field-odd"><p>(float 5xn) - fluxes at each of those times for each
applied threshold</p>
</dd>
<dt class="field-even">All_threshold_fluences</dt>
<dd class="field-even"><p>(float 1xn array) - fluence values for integral
or estimated integral fluxes in the n energy channels for which
thresholds were applied</p>
</dd>
<dt class="field-odd">All_fluence</dt>
<dd class="field-odd"><p>(float nxm array) - fluence spectrum in the original
integral or differential energy channels associated with
energy_bins. Fluence calculated between crossing_time and
event_end_time, so this is the fluence spectrum associated with
the events defined by the thresholds applied to each energy channel</p>
</dd>
<dt class="field-even">All_energies</dt>
<dd class="field-even"><p>(float 1xm array) - effective energies for energy_bins,
defined by sqrt(low bin edge*high bin edge)</p>
</dd>
<dt class="field-odd">Crossing_time</dt>
<dd class="field-odd"><p>(datetime 1xn array) - SEP event start time for each
applied threshold</p>
</dd>
<dt class="field-even">Peak_flux</dt>
<dd class="field-even"><p>(float 1xn array) - maximum flux for each applied threshold</p>
</dd>
<dt class="field-odd">Peak_time</dt>
<dd class="field-odd"><p>(datetime 1xn array) - time of maximum flux for each applied
threshold</p>
</dd>
<dt class="field-even">Rise_time</dt>
<dd class="field-even"><p>(timedelta 1xn array) - start time to max flux</p>
</dd>
<dt class="field-odd">Event_end_time</dt>
<dd class="field-odd"><p>(datetime 1xn array) - end time for each applied threshold</p>
</dd>
<dt class="field-even">Duration</dt>
<dd class="field-even"><p>(timedelta 1xn array) - end time minus start time</p>
</dd>
<dt class="field-odd">Onset_peak</dt>
<dd class="field-odd"><p>(float 1xn array) - onset peak for each applied threshold</p>
</dd>
<dt class="field-even">Onset_date</dt>
<dd class="field-even"><p>(datetime 1xn array) - onset peak time for each applied
threshold</p>
</dd>
<dt class="field-odd">Integral_fluxes</dt>
<dd class="field-odd"><p>(float nxq array) - flux time profiles of integral
or estimated integral fluxes for n energy channels and m time steps</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<p>(thresholds applied to differential channels have been
appended; define d as the number of differential channels for
which the user applied a threshold.
n+d = total number of thresholds applied to energy channels):</p>
<dl class="field-list simple">
<dt class="field-odd">Energy_thresholds</dt>
<dd class="field-odd"><p>(float 1x(n+d) array)</p>
</dd>
<dt class="field-even">Flux_thresholds</dt>
<dd class="field-even"><p>(float 1x(n+d) array)</p>
</dd>
<dt class="field-odd">Plot_diff_thresh</dt>
<dd class="field-odd"><p>(bool 1x(n+d) array)</p>
</dd>
<dt class="field-even">Plt_energy</dt>
<dd class="field-even"><p>(float 1x(n+d) array)</p>
</dd>
<dt class="field-odd">Plt_flux</dt>
<dd class="field-odd"><p>(float 1x(n+d) array)</p>
</dd>
<dt class="field-even">All_threshold_fluences</dt>
<dd class="field-even"><p>(float 1x(n+d) array)</p>
</dd>
<dt class="field-odd">All_fluence</dt>
<dd class="field-odd"><p>(float (n+d)xm array)</p>
</dd>
<dt class="field-even">All_energies</dt>
<dd class="field-even"><p>(float 1xm array)</p>
</dd>
<dt class="field-odd">Crossing_time</dt>
<dd class="field-odd"><p>(datetime 1x(n+d) array)</p>
</dd>
<dt class="field-even">Peak_flux</dt>
<dd class="field-even"><p>(float 1x(n+d) array)</p>
</dd>
<dt class="field-odd">Peak_time</dt>
<dd class="field-odd"><p>(datetime 1x(n+d) array)</p>
</dd>
<dt class="field-even">Rise_time</dt>
<dd class="field-even"><p>(timedelta 1x(n+d) array)</p>
</dd>
<dt class="field-odd">Event_end_time</dt>
<dd class="field-odd"><p>(datetime 1x(n+d) array)</p>
</dd>
<dt class="field-even">Duration</dt>
<dd class="field-even"><p>(timedelta 1x(n+d) array)</p>
</dd>
<dt class="field-odd">Onset_date</dt>
<dd class="field-odd"><p>(datetime 1x(n+d) array)</p>
</dd>
<dt class="field-even">Onset_peak</dt>
<dd class="field-even"><p>(float 1x(n+d) array)</p>
</dd>
<dt class="field-odd">Integral_fluxes</dt>
<dd class="field-odd"><p>(float (n+d)xq array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.calculate_event_info">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">calculate_event_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detect_prev_event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_thresh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.calculate_event_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies energy and flux thresholds to calculate SEP event quantities:</p>
<blockquote>
<div><ul class="simple">
<li><p>Threshold crossing time (onset)</p></li>
<li><p>Peak Flux in date range specified by user</p></li>
<li><p>Time of Peak Flux</p></li>
<li><p>Rise Time (onset to peak flux)</p></li>
<li><p>Event End Time (below 0.85*threshold for 3 data points, e.g 15 min)</p></li>
<li><p>Duration (onset to end)</p></li>
</ul>
</div></blockquote>
<p>If the detect_prev_event flag is set to true and the threshold is crossed
on the first time in the specified date range, this indicates that fluxes
were already high due to a previous event. The code will look for the
flux to drop below threshold and then increase above threshold again
during the specified time period. If this flag is not set, then the code
simply take the first threshold crossing as the start of the SEP event.</p>
<p>If the two_peaks flag is set to true, the code will use the first
identified threshold crossing as the start time. A second threshold
crossing will be allowed. The event end will be determined as the drop
below threshold after the second threshold crossing. The duration will
be the end time - first threshold crossing time. The peak will be
determined as the largest flux value found in both threshold crossings.
The peak and rise times will be calculated from the first threshold
crossing time.</p>
<p>NOTE: integral_fluxes is a “historic” name and may actual contain
integral or differential fluxes. They correspond to the flux channels
for which a threshold has been applied.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Energy_thresholds</dt>
<dd class="field-odd"><p>(float 1xn array) - energy channels for which a
threshold is applied</p>
</dd>
<dt class="field-even">Flux_thresholds</dt>
<dd class="field-even"><p>(float 1xn array) - flux thresholds to apply</p>
</dd>
<dt class="field-odd">Dates</dt>
<dd class="field-odd"><p>(datetime 1xm array)</p>
</dd>
<dt class="field-even">Integral_fluxes</dt>
<dd class="field-even"><p>(float nxm array) - fluxes only associated with the
energy channels in energy_thresholds</p>
</dd>
<dt class="field-odd">Detect_prev_event</dt>
<dd class="field-odd"><p>(boolean)</p>
</dd>
<dt class="field-even">Two_peaks</dt>
<dd class="field-even"><p>(boolean)</p>
</dd>
<dt class="field-odd">Diff_thresh</dt>
<dd class="field-odd"><p>(boolean) - indicates if the energy_threshold and
flux_threshold refer to a differential channel (True)</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Crossing_time</dt>
<dd class="field-odd"><p>(datetime 1xn array) - crossing times for n applied thresholds</p>
</dd>
<dt class="field-even">Peak_flux</dt>
<dd class="field-even"><p>(float 1xn array) - max flux value between start and end time</p>
</dd>
<dt class="field-odd">Peak_time</dt>
<dd class="field-odd"><p>(datetime 1xn array)</p>
</dd>
<dt class="field-even">Rise_time</dt>
<dd class="field-even"><p>(timedelta 1xn array) - (peak_time - crossing_time)</p>
</dd>
<dt class="field-odd">Event_end_time</dt>
<dd class="field-odd"><p>(datetime 1xn array)</p>
</dd>
<dt class="field-even">Duration</dt>
<dd class="field-even"><p>(timedelta 1xn arrat) - (event_end_time - crossing_time)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.calculate_fluence">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">calculate_fluence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.calculate_fluence" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine sums up all of the flux in the 1xn array “flux”. The
“dates” and “flux” arrays input here should reflect only the intensities
between the SEP start and stop times, determined by the subroutine
calculate_threshold_crossing. The subroutine does not differentiate between
differential or integral flux.</p>
<p>The extract_date_range subroutine is used prior to calling this one to
make the dates and fluxes arrays covering only the SEP time period.
The flux will be multiplied by time_resolution and summed for all of the
data between the start and end times. Negative or bad flux values
should have been set to None or interpolated with check_bad_data().
None values will be skipped.</p>
<p>The time resolution is found by taking the difference between
every consecutive data point. The most common difference is
taken as the time resolution. Even if the data set has gaps,
if there are enough consecutive time points in the observational
or model output, the correct time resolution should be identified.</p>
<p>Fluence units will be 1/[MeV cm^2] for GOES or SEPEM differential
fluxes or 1/[cm^2] for integral fluxes.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Flux</dt>
<dd class="field-odd"><p>(float 1xn array) - intensity time series for a single energy bin
or single integral channel (1D array).</p>
</dd>
<dt class="field-even">Dates</dt>
<dd class="field-even"><p>(datetime 1xn array) - datetimes that correspond to the fluxes</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Fluence</dt>
<dd class="field-odd"><p>(float) - sum of all the flux values in flux</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.calculate_integral_fluences">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">calculate_integral_fluences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_threshold_fluences</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_fluence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_energies</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.calculate_integral_fluences" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate fluence values for all integral energy thresholds
between start and end times determined in each channel.
This subroutine is only called for the thresholds applied
to integral channels.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Experiment</dt>
<dd class="field-odd"><p>(string)</p>
</dd>
<dt class="field-even">Flux_type</dt>
<dd class="field-even"><p>(string) - integral, differential</p>
</dd>
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>(string array) - options that could be applied</p>
</dd>
<dt class="field-even">Model_name</dt>
<dd class="field-even"><p>(string) - model name or experiment if experiment = “user”</p>
</dd>
<dt class="field-odd">DoBGSub</dt>
<dd class="field-odd"><p>(bool) - indicate if background subtraction to be performed</p>
</dd>
<dt class="field-even">Startdate</dt>
<dd class="field-even"><p>(datetime) - start date of time period entered by user</p>
</dd>
<dt class="field-odd">Enddate</dt>
<dd class="field-odd"><p>(datetime) - end date of time period entered by user</p>
</dd>
<dt class="field-even">Energy_bins</dt>
<dd class="field-even"><p>(float 2xp array) - energy bins for all of the flux channels</p>
</dd>
<dt class="field-odd">Energy_thresholds</dt>
<dd class="field-odd"><p>(float 1xn array) - energy channels for which a
threshold is applied (at this point, only the integral ones)</p>
</dd>
<dt class="field-even">Flux_thresholds</dt>
<dd class="field-even"><p>(float 1xn array) - flux thresholds applied to
the energy channels in energy_thresholds</p>
</dd>
<dt class="field-odd">Dates</dt>
<dd class="field-odd"><p>(datetime 1xm array) - time points for the flux time profiles</p>
</dd>
<dt class="field-even">Fluxes</dt>
<dd class="field-even"><p>(float pxm array) - flux time profiles for p energy bins and m
time steps</p>
</dd>
<dt class="field-odd">Integral_fluxes</dt>
<dd class="field-odd"><p>(float nxm array) - flux time profiles of integral
or estimated integral fluxes for n energy channels and m time steps</p>
</dd>
<dt class="field-even">Crossing_time</dt>
<dd class="field-even"><p>(datetime 1xn array) - SEP event start times for each
energy channel with an applied threshold</p>
</dd>
<dt class="field-odd">Event_end_time</dt>
<dd class="field-odd"><p>(datetime 1xn array) - SEP event end times for each
energy channel with an applied threshold</p>
</dd>
<dt class="field-even">All_threshold_fluences</dt>
<dd class="field-even"><p>(float 1xn array) - fluence values for integral
or estimated integral fluxes in the n energy channels for which
thresholds were applied</p>
</dd>
<dt class="field-odd">All_fluence</dt>
<dd class="field-odd"><p>(float nxp array) - fluence spectrum in the original
integral or differential energy channels associated with
energy_bins. Fluence calculated between crossing_time and
event_end_time, so this is the fluence spectrum associated with
the events defined by the thresholds applied to each energy channel</p>
</dd>
<dt class="field-even">All_energies</dt>
<dd class="field-even"><p>(float 1xp array) - effective energies for energy_bins,
defined by sqrt(low bin edge*high bin edge)</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<p>Arrays filled in for the integral thresholds:</p>
<dl class="field-list simple">
<dt class="field-odd">All_threshold_fluences</dt>
<dd class="field-odd"><p>(float 1xn array) - fluence values for integral
or estimated integral fluxes in the n energy channels for which
thresholds were applied</p>
</dd>
<dt class="field-even">All_fluence</dt>
<dd class="field-even"><p>(float nxp array) - fluence spectrum in the original
integral or differential energy channels associated with
energy_bins. Fluence calculated between crossing_time and
event_end_time, so this is the fluence spectrum associated with
the events defined by the thresholds applied to each energy channel</p>
</dd>
<dt class="field-odd">All_energies</dt>
<dd class="field-odd"><p>(float 1xp array) - effective energies for energy_bins,
defined by sqrt(low bin edge*high bin edge)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.calculate_onset_peak">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">calculate_onset_peak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplot</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.calculate_onset_peak" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the peak associated with the initial SEP onset. This subroutine
searches for the rollover that typically occurs after the SEP onset.
The peak value will be specified as the flux value at the rollover
location.
If the event peak is larger than 500/energy channel (e.g. for &gt;10
MeV, if peak is above 50 pfu), then the rollover will be found
starting from the threshold crossing time.
If the event is a “weaker” event with a maximum below the value above,
the rollover location will be identified starting from 12 hours (buffer)
prior to threshold crossing time. The onset peak time may be BEFORE
THE EVENT START TIME with this logic, but is more independent of the
level of the threshold and more linked to the behavior of the flux
time profile.
The onset peak may provide a more physically appropriate comparison
with models.
If code cannot identify onset peak, it will return a value of 0 on
the date None.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Experiment</dt>
<dd class="field-odd"><p>(string) e.g. GOES-13</p>
</dd>
<dt class="field-even">Energy_thresholds</dt>
<dd class="field-even"><p>(float 1xn array) - energy channels for which thresholds
are applied</p>
</dd>
<dt class="field-odd">Dates</dt>
<dd class="field-odd"><p>(datetime 1xm array) - dates associated with flux time profile</p>
</dd>
<dt class="field-even">Integral_fluxes</dt>
<dd class="field-even"><p>(float nxm array) - fluxes for each energy channel for
which a threshold is applied; each is the same length as dates</p>
</dd>
<dt class="field-odd">Crossing_time</dt>
<dd class="field-odd"><p>(datetime 1xn array) - threshold crossing times for each energy
channel for which a threshold is applied</p>
</dd>
<dt class="field-even">Event_end_time</dt>
<dd class="field-even"><p>(datetime 1xn array) - end times for each energy channel for which
a threshold is applied</p>
</dd>
<dt class="field-odd">Showplot</dt>
<dd class="field-odd"><p>(bool)</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Onset_date</dt>
<dd class="field-odd"><p>(datetime 1xn array) - time of onset peak</p>
</dd>
<dt class="field-even">Onset_peak</dt>
<dd class="field-even"><p>(float 1xn array) - flux value of onset peak</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.calculate_threshold_crossing">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">calculate_threshold_crossing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.calculate_threshold_crossing" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the time that a threshold is crossed.
Operational thresholds used by the NASA JSC Space Radiation Analysis
Group to determine actions that should be taken during an SEP event are:</p>
<blockquote>
<div><ul class="simple">
<li><p>&gt;10 MeV proton flux exceeds 10 pfu (1/[cm^2 s sr])</p></li>
<li><p>&gt;100 MeV proton flux exceeds 1 pfu (1/[cm^2 s sr])</p></li>
</ul>
</div></blockquote>
<p>An SEP event is considered to start if 3 consecutive points are
above threshold. The start time is set to the first point that crossed
threshold.</p>
<p>Values are calcualated for any additional thresholds provided by user.</p>
<p>This program also calculates peak flux and time of peak flux for time
period specified by user. It then calculates rise time by comparing:
rise time = time of peak flux - threshold crossing time
If no thresholds are crossed during specified time period, peak time
and rise time will be 0.
The event end time is much more subjective. For this program, I follow
the code that officially calls the end of an event when SRAG supports
ISS operations. When the flux has three consecutive points (15 minutes
of GOES data) below 0.85*threshold, then the event is ended. The end time
is corrected back to the first of the three data points. This end
criteria has no physics basis. It simply ensures that a new event will
not erroneously begin within the SRAG SEP alarm code due to flux
fluctuations around threshold as the SEP flux decays away slowly.
If the time period specified by the user ends before the event falls
below 0.85*threshold, then the event_end_time is set to the last time
in the specified time range. The program will give a message indicating
that the user may want to extend the requested time frame in order to
better-capture the end of the event.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Energy_threshold</dt>
<dd class="field-odd"><p>(float) - energy channel for which the
flux threshold value should be applied</p>
</dd>
<dt class="field-even">Flux_threshold</dt>
<dd class="field-even"><p>(float) - flux threshold value</p>
</dd>
<dt class="field-odd">Dates</dt>
<dd class="field-odd"><p>(datetime 1xn array) - dates associated with the flux time profile</p>
</dd>
<dt class="field-even">Fluxes</dt>
<dd class="field-even"><p>(float 1xn array) - flux with time for the single energy channel
associated with energy_threshold</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Crossing_time</dt>
<dd class="field-odd"><p>(datetime)</p>
</dd>
<dt class="field-even">Peak_flux</dt>
<dd class="field-even"><p>(float) - maximum flux value between start and end time</p>
</dd>
<dt class="field-odd">Peak_time</dt>
<dd class="field-odd"><p>(datetime)</p>
</dd>
<dt class="field-even">Rise_time</dt>
<dd class="field-even"><p>(timedelta) - (peak_time - crossing_time)</p>
</dd>
<dt class="field-odd">Event_end_time</dt>
<dd class="field-odd"><p>(datetime)</p>
</dd>
<dt class="field-even">Duration</dt>
<dd class="field-even"><p>(timedelta) - (event_end_time - crossing_time)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.calculate_umasep_info">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">calculate_umasep_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.calculate_umasep_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the integral fluxes (either input or estimated from differential
channels) and all the energy and flux thresholds set in the main program
to calculate SEP event quantities specific to the UMASEP model.</p>
<blockquote>
<div><p>Flux at threshold crossing time + 3, 4, 5, 6, 7 hours</p>
</div></blockquote>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Energy_thresholds</dt>
<dd class="field-odd"><p>(float 1xn array) - energy channels for which thresholds
are applied</p>
</dd>
<dt class="field-even">Flux_thresholds</dt>
<dd class="field-even"><p>(float 1xn array) - flux thresholds that are applied</p>
</dd>
<dt class="field-odd">Dates</dt>
<dd class="field-odd"><p>(datetime 1xm array) - dates associated with flux time profile</p>
</dd>
<dt class="field-even">Integral_fluxes</dt>
<dd class="field-even"><p>(float nxm array) - fluxes for each energy channel for
which a threshold is applied; each is the same length as dates</p>
</dd>
<dt class="field-odd">Crossing_time</dt>
<dd class="field-odd"><p>(datetime 1xn array) - threshold crossing times for each energy
channel for which a threshold is applied</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Proton_delay_times</dt>
<dd class="field-odd"><p>(datetime nx5 array) - times 3, 4, 5, 6, 7 hours
after crossing time for n thresholds</p>
</dd>
<dt class="field-even">Proton_flux</dt>
<dd class="field-even"><p>(float nx5 array) - value of flux at each delay time and for
each threshold</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.check_bin_exists">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">check_bin_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.check_bin_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>If a user specifies a threshold for a differential energy bin, check
to see that the energy bin is in the requested data set.
threshold is a list of strings.
Expect threshold[0] = lowedge-highedge, threshold[1] = flux value</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Threshold</dt>
<dd class="field-odd"><p>(string) - threshold input by user in string format</p>
</dd>
<dt class="field-even">Energy_bins</dt>
<dd class="field-even"><p>(float 2xn array) - energy bins for n energy channels</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Boolean</dt>
<dd class="field-odd"><p>indicating specified bins exist, or exit</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.consistent_peak_fluxes">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">consistent_peak_fluxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_peak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.consistent_peak_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>If a threshold is not crossed, then the max flux is saved
as zero and the onset peak is saved as the maximum value
in the time range considered. This is technically
not correct.
Swapping the two values to more correct.</p>
<p>INPUTS (for n SEP events):</p>
<dl class="field-list simple">
<dt class="field-odd">Crossing_time</dt>
<dd class="field-odd"><p>(datetime 1xn array) - value will be zero
if no threshold was crossed</p>
</dd>
<dt class="field-even">Onset_peak</dt>
<dd class="field-even"><p>(float 1xn array) - value of onset peak for each
SEP event, max flux if no thresholds crossed</p>
</dd>
<dt class="field-odd">Onset_date</dt>
<dd class="field-odd"><p>(datetime 1xn array) - time of onset peaks</p>
</dd>
<dt class="field-even">Peak_flux</dt>
<dd class="field-even"><p>(float 1xn array) - values of maximum flux for
each SEP event, zero if no threshold crossed</p>
</dd>
<dt class="field-odd">Peak_time</dt>
<dd class="field-odd"><p>(datetime 1xn array) - value of peak flux, zero if
threshold not crossed</p>
</dd>
</dl>
<p>OUTPUTS (same as above, but values switched around):</p>
<dl class="field-list simple">
<dt class="field-odd">Onset_peak</dt>
<dd class="field-odd"><p>value set to zero if no threshold crossed</p>
</dd>
<dt class="field-even">Onset_date</dt>
<dd class="field-even"><p>value set to zero if no threshold crossed</p>
</dd>
<dt class="field-odd">Peak_flux</dt>
<dd class="field-odd"><p>value of max flux during time period</p>
</dd>
<dt class="field-even">Peak_time</dt>
<dd class="field-even"><p>time of max flux</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.define_thresholds">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">define_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_diff_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.define_thresholds" title="Permalink to this definition">¶</a></dt>
<dd><p>Two operational thresholds plus any thresholds
specified by the user.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Input_threshold</dt>
<dd class="field-odd"><p>(float 2xn array) - thresholds specified by user e.g.
[[30,1],[50,1]]</p>
</dd>
<dt class="field-even">Is_diff_thresh</dt>
<dd class="field-even"><p>(bool 1xn array) - indicates whether the input threshold
is a differential channel</p>
</dd>
<dt class="field-odd">Str_thresh</dt>
<dd class="field-odd"><p>(string) - threshold as input by user in command line e.g.
“30,1;50,1;4.9-8.3,10”</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Energy_thresholds</dt>
<dd class="field-odd"><p>(float 1x(n+2) array) - e.g. [10,100,30,50,4.9]
energy channels for which a threshold will be applied. Includes
the two operational thresholds plus any thresholds entered by
the user</p>
</dd>
<dt class="field-even">Flux_thresholds</dt>
<dd class="field-even"><p>(float 1x(n+2) array) - e.g. [10,1,1,1,10]
flux thresholds to be applied to the energy channels in
energy_thresholds. Includes the two operational thresholds
plus any thresholds entered by the user</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.determine_time_resolution">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">determine_time_resolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.determine_time_resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>The time resolution is found by taking the difference between
every consecutive data point. The most common difference is
taken as the time resolution. Even if the data set has gaps,
if there are enough consecutive time points in the observational
or model output, the correct time resolution should be identified.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Dates</dt>
<dd class="field-odd"><p>(datetime 1xm array) - dates associated with flux time profile</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Time_resolution</dt>
<dd class="field-odd"><p>(time delta object)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.error_check_inputs">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">error_check_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">startdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_diff_thresh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.error_check_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that all of the user inputs make sense and fall within bounds.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Startdate</dt>
<dd class="field-odd"><p>(datetime) - start of time period entered by user</p>
</dd>
<dt class="field-even">Enddate</dt>
<dd class="field-even"><p>(datetime) - end of time period entered by user</p>
</dd>
<dt class="field-odd">Experiment</dt>
<dd class="field-odd"><p>(string) - name of experiment specifed by user</p>
</dd>
<dt class="field-even">Flux_type</dt>
<dd class="field-even"><p>(string) - integral or differential</p>
</dd>
<dt class="field-odd">Json_type</dt>
<dd class="field-odd"><p>(string) - model or observations, only needed if “user” experiment</p>
</dd>
<dt class="field-even">Is_diff_thresh</dt>
<dd class="field-even"><p>(bool 1xn array) - where n indicates the number of
thresholds input by the user, e.g. “30,1;50,1” n=2
Indicates if the user-input thresholds apply to integral or
differential channels</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<p>None, but system exit if error found</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.error_check_options">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">error_check_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.error_check_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Make sure the selected options make sense for the experiment.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Experiment</dt>
<dd class="field-odd"><p>(string)</p>
</dd>
<dt class="field-even">Flux_type</dt>
<dd class="field-even"><p>(string) - integral or differential</p>
</dd>
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>(string array) - various options applied to GOES data</p>
</dd>
<dt class="field-even">DoBGSub</dt>
<dd class="field-even"><p>(boolean) - indicates if background subtraction to be
performed</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<p>no outputs by system exit if error found</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.extract_integral_fluxes">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">extract_integral_fluxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.extract_integral_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Select or create the integral fluxes that correspond to the desired
energy thresholds.
If the user selected differential fluxes, then the
differential fluxes will be converted to integral fluxes with the
minimum energy defined by the set energy thresholds.
If the user selected integral fluxes, then the channels corresponding to
the desired energy thresholds will be identified.
If an energy channel with a specified is not present, will return a
None value for the integral fluxes, and remove that threshold in
run_all. (e.g. if &gt;100 MeV fluxes were not in the data or model
fluxes, return a None value for integral fluxes and remove the
&gt;100 MeV, 1 pfu threshold.)</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Fluxes</dt>
<dd class="field-odd"><p>(float nxm array) - flux time profile for each energy channel</p>
</dd>
<dt class="field-even">Experiment</dt>
<dd class="field-even"><p>(string)</p>
</dd>
<dt class="field-odd">Flux_type</dt>
<dd class="field-odd"><p>(string) - integral or differential</p>
</dd>
<dt class="field-even">Flux_thresholds</dt>
<dd class="field-even"><p>(float 1xp array) - flux threshold values</p>
</dd>
<dt class="field-odd">Energy_thresholds</dt>
<dd class="field-odd"><p>(float 1xp array) - energy channels to which the
flux threshold values are applied</p>
</dd>
<dt class="field-even">Energy_bins</dt>
<dd class="field-even"><p>(float 1xn array) - bins for each energy channel in fluxes</p>
</dd>
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>(string array) - bg subtraction, effective energies for
GOES channels</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Integral_fluxes</dt>
<dd class="field-odd"><p>(float array) - integral fluxes associated with each
energy channel in energy_thresholds; &gt;energy_thresholds[i]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.from_differential_to_integral_flux">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">from_differential_to_integral_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.from_differential_to_integral_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>If user selected differential fluxes, convert to integral fluxes to
caluculate operational threshold crossings (&gt;10 MeV protons exceed 10
pfu, &gt;100 MeV protons exceed 1 pfu).
Assume that the measured fluxes correspond to the center of the energy
bin and use power law interpolation to extrapolate integral fluxes
above user input min_energy.
The intent is to calculate &gt;10 MeV and &gt;100 MeV fluxes, but leaving
flexibility for user to define the minimum energy for the integral flux.
An integral flux will be provided for each timestamp (e.g. every 5 mins).</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Experiment</dt>
<dd class="field-odd"><p>(string)</p>
</dd>
<dt class="field-even">Min_energy</dt>
<dd class="field-even"><p>(float) - bottom energy for integral flux calculation</p>
</dd>
<dt class="field-odd">Energy_bins</dt>
<dd class="field-odd"><p>(float 1xn array) - bins for each energy channel</p>
</dd>
<dt class="field-even">Fluxes</dt>
<dd class="field-even"><p>(float nxm array) - fluxes with time for each energy channel</p>
</dd>
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>(string array) - effective energies for GOES channels</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Integral_fluxes</dt>
<dd class="field-odd"><p>(float 1xm array) - estimate integral flux for &gt;min_energy
(Returns all zero values if no energy bins above min_energy)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.get_energy_bin_index">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">get_energy_bin_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.get_energy_bin_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the index associated with the integral or differential energy bin, check
to see that the energy bin is in the requested data set.
threshold is a list of strings.
For integral, expect:</p>
<blockquote>
<div><ul class="simple">
<li><p>energy_threshold = lowedge</p></li>
</ul>
</div></blockquote>
<p>For differential, expect:</p>
<blockquote>
<div><ul class="simple">
<li><p>energy_threshold[0] = lowedge</p></li>
<li><p>energy_threshold[1] = highedge</p></li>
</ul>
</div></blockquote>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Energy_threshold</dt>
<dd class="field-odd"><p>(float or 1x2 array)</p>
</dd>
<dt class="field-even">Energy_bins</dt>
<dd class="field-even"><p>(float 2xn array) - energy bins for n energy channels</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Index</dt>
<dd class="field-odd"><p>(integer) - index of energy bin associated with energy_threshold</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.get_fluence_spectrum">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">get_fluence_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.get_fluence_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the fluence spectrum for each of the energy channels in the
user selected data set. If the user selected differential fluxes, then
the fluence values correspond to each energy bin. If the user selected
integral fluxes, then the fluence values correspond to each integral bin.
Writes fluence values to file according to boolean save_file.
If the user input a threshold for a differential energy bin,
is_diff_thresh will be true and the filename will not contain “gt”.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Experiment</dt>
<dd class="field-odd"><p>(string)</p>
</dd>
<dt class="field-even">Flux_type</dt>
<dd class="field-even"><p>(string) - integral or differential</p>
</dd>
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>(string array) - bg subtraction, effective energies for
GOES channels</p>
</dd>
<dt class="field-even">Model_name</dt>
<dd class="field-even"><p>(string) - name of model or user experiment, if relevant</p>
</dd>
<dt class="field-odd">Energy_threshold</dt>
<dd class="field-odd"><p>(float) - energy channel to which the
flux threshold value is applied</p>
</dd>
<dt class="field-even">Flux_threshold</dt>
<dd class="field-even"><p>(float) - flux threshold value</p>
</dd>
<dt class="field-odd">Sep_dates</dt>
<dd class="field-odd"><p>(datetime 1xm array) - dates trimmed between SEP start and
end times</p>
</dd>
<dt class="field-even">Sep_fluxes</dt>
<dd class="field-even"><p>(float nxm array) - flux time profiles for each energy channel
trimmed between SEP start and end times</p>
</dd>
<dt class="field-odd">Energy_bins</dt>
<dd class="field-odd"><p>(float 1xn array) - bins for each energy channel</p>
</dd>
<dt class="field-even">Diff_thresh</dt>
<dd class="field-even"><p>(boolean) - indicates if the energy_threshold and
flux_threshold refer to a differential channel (True)</p>
</dd>
<dt class="field-odd">Save_file</dt>
<dd class="field-odd"><p>(boolean) - set True to save fluence values to file</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Fluence</dt>
<dd class="field-odd"><p>(float 1xn array) - fluence value in each energy bin</p>
</dd>
<dt class="field-even">Energies</dt>
<dd class="field-even"><p>(float 1xn array) - bin centers for each energy bin</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.get_input_thresholds">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">get_input_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">str_thresh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.get_input_thresholds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get user specified input thresholds,</p>
<p>INPUTS:
:str_thresh: (string) input by user with thresholds</p>
<blockquote>
<div><p>separated by semi-colons</p>
</div></blockquote>
<p>OUTPUTS:</p>
<dl class="field-list">
<dt class="field-odd">Input_threshold</dt>
<dd class="field-odd"><p>(2xn floats) array as
[[binLow, flux threshold],</p>
<blockquote>
<div><p>[bin Low, fluxthreshold],
…]</p>
</div></blockquote>
</dd>
<dt class="field-even">Is_diff_thresh</dt>
<dd class="field-even"><p>(bool array)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.print_values_to_file">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">print_values_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_peak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rise_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_fluences</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_diff_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep_fluxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.print_values_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write all calculated values to file for all thresholds. Event-integrated
fluences for &gt;10, &gt;100 MeV (and user-defined threshold) will also be
included. Writes out file with name e.g.
output/sep_values_experiment_fluxtype_YYYY_M_D.csv
If the UMASEP option was selected, add on the proton values calculated
at the UMASEP Ts + Xhr time points.
is_diff_thresh indicates whether the user input a differential
threshold. If so, the user threshold bin(s) will refer to differential
fluxes.</p>
<p>Writes all values out to a csv file. These values and more are also
written out to json file in a different subroutine.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Experiment</dt>
<dd class="field-odd"><p>(string)</p>
</dd>
<dt class="field-even">Flux_type</dt>
<dd class="field-even"><p>(string) - integral or differential</p>
</dd>
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>(string array) - can be S14, Bruno2017, uncorrected and apply
to GOES data</p>
</dd>
<dt class="field-even">DoBGSub</dt>
<dd class="field-even"><p>(boolean) - indicates if background subtraction performed</p>
</dd>
<dt class="field-odd">Model_name</dt>
<dd class="field-odd"><p>(string) - model or experiment name if experiment = “user”</p>
</dd>
<dt class="field-even">Startdate</dt>
<dd class="field-even"><p>(datetime) - start date of time period entered by user</p>
</dd>
<dt class="field-odd">Energy_thresholds</dt>
<dd class="field-odd"><p>(float 1xn array) - all energy channels for which
a flux threshold was applied (both integral and differential)</p>
</dd>
<dt class="field-even">Flux_thresholds</dt>
<dd class="field-even"><p>(float 1xn array) - flux thresholds for each of the
energy channels in energy_thresholds</p>
</dd>
<dt class="field-odd">Crossing_time</dt>
<dd class="field-odd"><p>(datetime 1xn array) - SEP event start time for each
applied threshold</p>
</dd>
<dt class="field-even">Onset_peak</dt>
<dd class="field-even"><p>(float 1xn array) - onset peak for each applied threshold</p>
</dd>
<dt class="field-odd">Onset_date</dt>
<dd class="field-odd"><p>(datetime 1xn array) - onset peak time for each applied
threshold</p>
</dd>
<dt class="field-even">Peak_flux</dt>
<dd class="field-even"><p>(float 1xn array) - maximum flux for each applied threshold</p>
</dd>
<dt class="field-odd">Peak_time</dt>
<dd class="field-odd"><p>(datetime 1xn array) - time of maximum flux for each applied
threshold</p>
</dd>
<dt class="field-even">Rise_time</dt>
<dd class="field-even"><p>(timedelta 1xn array) - start time to max flux</p>
</dd>
<dt class="field-odd">Event_end_time</dt>
<dd class="field-odd"><p>(datetime 1xn array) - end time for each applied threshold</p>
</dd>
<dt class="field-even">Duration</dt>
<dd class="field-even"><p>(timedelta 1xn array) - end time minus start time</p>
</dd>
<dt class="field-odd">Threshold_fluences</dt>
<dd class="field-odd"><p>(float 1xn array) - event fluence for each energy
channel in energy_thresholds</p>
</dd>
<dt class="field-even">Is_diff_thresh</dt>
<dd class="field-even"><p>(bool 1xn array) - indicates if threshold applied to
integral or differential channel, e.g. if channel in energy_thresholds
is an integral or differential channel</p>
</dd>
<dt class="field-odd">Umasep</dt>
<dd class="field-odd"><p>(boolean) - indicate if user called UMASEP flag</p>
</dd>
<dt class="field-even">Umasep_times</dt>
<dd class="field-even"><p>(datetime 5xn array) - times 3, 4, 5, 6, 7, 9 hours after
crossing time for each applied threshold</p>
</dd>
<dt class="field-odd">Umasep_fluxes</dt>
<dd class="field-odd"><p>(float 5xn) - fluxes at each of those times for each
applied threshold</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Year</dt>
<dd class="field-odd"><p>(integer) - year of either SEP event or startdate (if no
thresholds crossed)</p>
</dd>
<dt class="field-even">Month</dt>
<dd class="field-even"><p>(integer) - month of either SEP event or startdate (if no
thresholds crossed)</p>
</dd>
<dt class="field-odd">Day</dt>
<dd class="field-odd"><p>(integer) - day of either SEP event or startdate (if no
thresholds crossed)</p>
</dd>
<dt class="field-even">Output file</dt>
<dd class="field-even"><p>named e.g.
output/sep_values_experiment_fluxtype_YYYY_M_D.csv</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.read_in_flux_files">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">read_in_flux_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_startdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_enddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_bgstartdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_bgenddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nointerp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveplot</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.read_in_flux_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in the appropriate data or user files. Performs
background subtraction, if requested. Trims to dates
between start time and end time. Interpolates bad
points with linear interpolation in time.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Experiment</dt>
<dd class="field-odd"><p>(string)</p>
</dd>
<dt class="field-even">Flux_type</dt>
<dd class="field-even"><p>(string) - integral, differential</p>
</dd>
<dt class="field-odd">User_file</dt>
<dd class="field-odd"><p>(string) - file containing user’s flux time profiles</p>
</dd>
<dt class="field-even">Model_name</dt>
<dd class="field-even"><p>(string) - model name or experiment if experiment = “user”</p>
</dd>
<dt class="field-odd">Startdate</dt>
<dd class="field-odd"><p>(datetime) - start date of time period entered by user</p>
</dd>
<dt class="field-even">Enddate</dt>
<dd class="field-even"><p>(datetime) - end date of time period entered by user</p>
</dd>
<dt class="field-odd">Str_startdate</dt>
<dd class="field-odd"><p>(string) - start date in string form</p>
</dd>
<dt class="field-even">Str_enddate</dt>
<dd class="field-even"><p>(string) - end date in string form</p>
</dd>
<dt class="field-odd">Str_bgstartdate</dt>
<dd class="field-odd"><p>(string) - start date of time period to be used for
background subtraction</p>
</dd>
<dt class="field-even">Str_bgenddate</dt>
<dd class="field-even"><p>(string) - end date of time period to be used or
background subtraction</p>
</dd>
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>(string array) - options that could be applied</p>
</dd>
<dt class="field-even">DoBGSub</dt>
<dd class="field-even"><p>(bool) - indicate if background subtraction to be performed</p>
</dd>
<dt class="field-odd">Nointerp</dt>
<dd class="field-odd"><p>(bool) - indicates if user doesn’t want to do linear
interpolation in time for negative of bad flux values</p>
</dd>
<dt class="field-even">Showplot</dt>
<dd class="field-even"><p>(bool)</p>
</dd>
<dt class="field-odd">Saveplot</dt>
<dd class="field-odd"><p>(bool) - save plots automatically to “plots” directory</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Dates</dt>
<dd class="field-odd"><p>(datetime 1xm array) - times in flux time profile trimmed
between startdate and enddate</p>
</dd>
<dt class="field-even">Fluxes</dt>
<dd class="field-even"><p>(numpy float nxm array) - fluxes for n energy channels and m
time steps; these are background subtracted fluxes if background
subtraction was selected.</p>
</dd>
<dt class="field-odd">Energy_bins</dt>
<dd class="field-odd"><p>(array nx2 for n thresholds)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.report_threshold_fluences">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">report_threshold_fluences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_fluxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.report_threshold_fluences" title="Permalink to this definition">¶</a></dt>
<dd><p>Report fluences for specified thresholds, typically &gt;10, &gt;100 MeV.
These values are interesting to use for comparison with literature and
for quantifying event severity.</p>
<p>Assumes that energy_thresholds are referring to integral energy
channels.
Assumes that sep_fluxes are integral or estimated integral
fluxes for each energy channel in energy_thresholds.
If the input fluxes were differential, then this subroutine only
works correctly for integral energy_thresholds and matching sep_fluxes
that were estimated for each integral channel in energy_thresholds.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Experiment</dt>
<dd class="field-odd"><p>(string)</p>
</dd>
<dt class="field-even">Flux_type</dt>
<dd class="field-even"><p>(string) - integral or differential</p>
</dd>
<dt class="field-odd">Model_name</dt>
<dd class="field-odd"><p>(string) - name of model or experiment if experiment = “user”</p>
</dd>
<dt class="field-even">Energy_thresholds</dt>
<dd class="field-even"><p>(float 1xn array) - integral energy channels for
which a threshold has been applied</p>
</dd>
<dt class="field-odd">Energy_bins</dt>
<dd class="field-odd"><p>(float 2xm array) - energy bins for input fluxes</p>
</dd>
<dt class="field-even">Sep_dates</dt>
<dd class="field-even"><p>(datetime 1xp array) - time profile dates trimmed to
start and stop of SEP event</p>
</dd>
<dt class="field-odd">Sep_fluxes</dt>
<dd class="field-odd"><p>(float mxp array) - flux time profiles for each energy
channel trimmed to start and end dates</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Integral_fluence</dt>
<dd class="field-odd"><p>(float 1xn array) - event fluence for all
integral energy channels for which a threshold was applied</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.run_all">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">run_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">str_startdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_enddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spase_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveplot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detect_prev_event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_bgstartdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_bgenddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nointerp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.run_all" title="Permalink to this definition">¶</a></dt>
<dd><p>“Runs all subroutines and gets all needed values. Takes the command line
arguments as input. Code may be imported into other python scripts and
run using this routine.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Str_startdate</dt>
<dd class="field-odd"><p>(string) - user input start date “YYYY-MM-DD” or
“YYYY-MM-DD HH:MM:SS”</p>
</dd>
<dt class="field-even">Str_enddate</dt>
<dd class="field-even"><p>(string) - user input end date “YYYY-MM-DD” or
“YYYY-MM-DD HH:MM:SS”</p>
</dd>
<dt class="field-odd">Experiment</dt>
<dd class="field-odd"><p>(string) - “GOES-08” up to “GOES-15”, “SEPEM”, “SEPEMv3”,
“EPHIN”, “EPHIN_REleASE”, or “user”</p>
</dd>
<dt class="field-even">Flux_type</dt>
<dd class="field-even"><p>(string) - “integral” or “differential” indicates the type
of flux to read in</p>
</dd>
<dt class="field-odd">Model_name</dt>
<dd class="field-odd"><p>(string) - If model is “user”, set model_name to describe
your model or data set (e.g. MyModel), otherwise set to ‘’.</p>
</dd>
<dt class="field-even">User_file</dt>
<dd class="field-even"><p>(string) - Default is ‘’. If “user” is selected for experiment,
specify name of flux file.</p>
</dd>
<dt class="field-odd">Spase_id</dt>
<dd class="field-odd"><p>(string) - Default is ‘’. If you know the spase_id of you
model or experiment, enter it here for the json file</p>
</dd>
<dt class="field-even">Showplot</dt>
<dd class="field-even"><p>(bool) - Set to True to show plots when run</p>
</dd>
<dt class="field-odd">Saveplot</dt>
<dd class="field-odd"><p>(bool) - Set to True to automatically save plots to the
plots directory when run</p>
</dd>
<dt class="field-even">Detect_prev_event</dt>
<dd class="field-even"><p>(bool) - option for finding start of event</p>
</dd>
<dt class="field-odd">Two_peaks</dt>
<dd class="field-odd"><p>(bool) - option for extending event length</p>
</dd>
<dt class="field-even">Umasep</dt>
<dd class="field-even"><p>(boolean) - call flag to run code for specific time related
to the UMASEP model</p>
</dd>
<dt class="field-odd">Str_thresh</dt>
<dd class="field-odd"><p>(string) - user-input thresholds in the format “30,1”
for &gt;30 MeV exceeds 1 pfu, “4-7,0.01” for 4-7 MeV differential
channel exceeds 0.01.  “30,1;4-7,0.01” multiple thresholds
separated by semi-colon.</p>
</dd>
<dt class="field-even">Nointerp</dt>
<dd class="field-even"><p>(boolean) - set to true to fill in negative fluxes with None
value rather than filling in via linear interpolation in time</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Sep_year</dt>
<dd class="field-odd"><p>(integer) - year of start of SEP event or year of beginning
of user-input time period (if no threshold crossed)</p>
</dd>
<dt class="field-even">Sep_month</dt>
<dd class="field-even"><p>(integer) - month of start of SEP event or year of beginning
of user-input time period (if no threshold crossed)</p>
</dd>
<dt class="field-odd">Sep_day</dt>
<dd class="field-odd"><p>(integer) - day of start of SEP event or year of beginning
of user-input time period (if no threshold crossed)</p>
</dd>
<dt class="field-even">Jsonfname</dt>
<dd class="field-even"><p>(string) - name of saved json file (could include issue time,
which is the time that the program is run, so absolutely
need to pass file name back as argument)</p>
</dd>
<dt class="field-odd">And generates multiple plots</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.save_integral_fluxes_to_file">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">save_integral_fluxes_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_fluxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.save_integral_fluxes_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the time series of integral fluxes to a file. If the input
data set was in integral channels, then this file will contain exactly
the same values in the time series.
If the input data set was in differential energy bins, then this file
contains the estimated integral fluxes calculated in this program.</p>
<p>Writes out csv file with dates in first column and integral fluxes
for which a threshold was applied in the remaining columns. Writes
fluxes for full time period specified by user.
Any differential channels for which a threshold was applied are not
included in this file.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Experiment</dt>
<dd class="field-odd"><p>(string)</p>
</dd>
<dt class="field-even">Flux_type</dt>
<dd class="field-even"><p>(string) - integral or differential</p>
</dd>
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p>(string array) - S14, Bruno2017, uncorrected options for GOES data</p>
</dd>
<dt class="field-even">DoBGSub</dt>
<dd class="field-even"><p>(boolean) - indicates if background subtration is performed</p>
</dd>
<dt class="field-odd">Model_name</dt>
<dd class="field-odd"><p>(string) - name of model or user experiment, if relevant</p>
</dd>
<dt class="field-even">Energy_thresholds</dt>
<dd class="field-even"><p>(float 1xn array) - energy channels for which
flux thresholds are applied</p>
</dd>
<dt class="field-odd">Crossing_time</dt>
<dd class="field-odd"><p>(datetime 1xn array) - start times of sep event for each
energy channel (energy_thresolds) for which a threshold was applied</p>
</dd>
<dt class="field-even">Dates</dt>
<dd class="field-even"><p>(datetime 1xm array) - dates for flux time profile</p>
</dd>
<dt class="field-odd">Integral_fluxes</dt>
<dd class="field-odd"><p>(float nxm array) - flux time profiles for each energy channel
for which a threshold was applied; assumed to be (estimated)integral fluxes</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="simple">
<dt>No outputs except output file named e.g.</dt><dd><p>integral_fluxes_GOES-13_differential_2012_3_7.csv</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.sort_bin_order">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">sort_bin_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.sort_bin_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the order of the energy bins. Usually, bins go from
low to high energies, but some modelers or users may
go in reverse order. Usually expect:
[[10,20],[20,30],[30,40]]
But user may instead input files with fluxes in order of:
[[30,40],[20,30],[10,20]]</p>
<p>This subroutine will reorder the fluxes and energy_bins
to go in increasing order. If differential fluxes were input,
this reordering will ensure that integral fluxes are
estimated properly.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">All_fluxes</dt>
<dd class="field-odd"><p>(float nxm array) - fluxes for n energy channels
and m time points</p>
</dd>
<dt class="field-even">Energy_bins</dt>
<dd class="field-even"><p>(float 2xn array) - energy bins for each of the
energy channels</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Sort_fluxes</dt>
<dd class="field-odd"><p>(float nxm array) - same as above, but sorted so
that the lowest energy channel is first and highest is last</p>
</dd>
<dt class="field-even">Sort_bins</dt>
<dd class="field-even"><p>(float 2xn array) - same as above, but sorted</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.str_to_datetime">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">str_to_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.str_to_datetime" title="Permalink to this definition">¶</a></dt>
<dd><p>String date to datetime</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Date</dt>
<dd class="field-odd"><p>(string) - date as “YYYY-MM-DD” or “YYYY-MM-DD HH:MM:SS”</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Dt</dt>
<dd class="field-odd"><p>(datetime) - datetime conversion of date</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.write_info_to_file">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">write_info_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spase_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_peak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rise_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_threshold_fluences</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_fluence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_diff_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep_fluxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.write_info_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write information to csv and json file.
Writes all of the derived information for all the
energy-threshold combinations to file.</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Experiment</dt>
<dd class="field-odd"><p>(string)</p>
</dd>
<dt class="field-even">Flux_type</dt>
<dd class="field-even"><p>(string) differential or integral</p>
</dd>
<dt class="field-odd">Json_type</dt>
<dd class="field-odd"><p>(string) model or observations, indicates which json
template to use if the experiment is “user”</p>
</dd>
</dl>
<p>The remaining inputs here are the same as the outputs produced by
append_differential_thresholds() or have been described in other
subroutine. Please see the list
of those outputs for detailed explanations of these inputs.</p>
<p>OUTPUTS:</p>
<p>No outputs except files are written:</p>
<blockquote>
<div><ul class="simple">
<li><p>fluence spectra files for each energy channel for which a threshold was applied</p></li>
<li><p>integral fluxes in csv file for which a threshold was applied</p></li>
<li><p>flux time profiles in txt files for each energy channel for which a threshold was applied</p></li>
<li><p>json file in CCMC format containing blocks of information for each energy channel for which a threshold was applied</p></li>
<li><p>csv file containing all timing and peak flux values</p></li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.write_zulu_time_profile">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">write_zulu_time_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.write_zulu_time_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Write out the time profile with the date in the
first column as the ISO standard and flux in the
second column as:</p>
<p>YYYY-MM-DDTHH:MM:SSZ    Float</p>
<p>INPUTS:</p>
<dl class="field-list simple">
<dt class="field-odd">Filename</dt>
<dd class="field-odd"><p>(string) - name of file to write</p>
</dd>
<dt class="field-even">Date</dt>
<dd class="field-even"><p>(datetime 1xn array) - list of dates</p>
</dd>
<dt class="field-odd">Fluxes</dt>
<dd class="field-odd"><p>(float 1xn array) - corresponding fluxes</p>
</dd>
</dl>
<p>OUTPUTS:</p>
<p>None but writes output file with filename</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="read_datasets.html" class="btn btn-neutral float-right" title="read_datasets module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="modules.html" class="btn btn-neutral float-left" title="operational-sep all modules" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Kathryn Whitman.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>