

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>operational_sep_quantities module &mdash; operational_sep_quantities 3.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="run_multi_sep module" href="run_multi_sep.html" />
    <link rel="prev" title="compare_data_model module" href="compare_data_model.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> operational_sep_quantities
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="overall.html">Overall Description</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">operational-sep</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="compare_data_model.html">compare_data_model module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">operational_sep_quantities module</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_multi_sep.html">run_multi_sep module</a></li>
<li class="toctree-l2"><a class="reference internal" href="read_datasets.html">read_datasets module</a></li>
<li class="toctree-l2"><a class="reference internal" href="global_vars.html">global_vars module</a></li>
<li class="toctree-l2"><a class="reference internal" href="derive_background.html">derive_background module</a></li>
<li class="toctree-l2"><a class="reference internal" href="ccmc_json_handler.html">ccmc_json_handler module</a></li>
<li class="toctree-l2"><a class="reference internal" href="keys.html">keys module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">operational_sep_quantities</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">operational-sep</a> &raquo;</li>
        
      <li>operational_sep_quantities module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/operational_sep_quantities.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-operational_sep_quantities">
<span id="operational-sep-quantities-module"></span><h1>operational_sep_quantities module<a class="headerlink" href="#module-operational_sep_quantities" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.all_program_info">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">all_program_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.all_program_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Program description for operational_sep_quantities.py v3.0.</p>
<p>This program will calculate various useful pieces of operational
information about SEP events from GOES-08, -10, -11, -12, -13, -14, -15
data and the SEPEM (RSDv2 and RSDv3) dataset.</p>
<dl class="simple">
<dt>SEP event values are always calculated for threshold definitions:</dt><dd><p>&gt;10 MeV exceeds 10 pfu
&gt;100 MeV exceed 1 pfu</p>
</dd>
</dl>
<p>The user may add multiple additional thresholds through the command line.
This program will check if data is already present in a ‘data’ directory. If
not, GOES or EPHIN data will be automatically downloaded from the web. SEPEM
(RSDv2 and RSDv3) data must be downloaded by the user and unzipped inside
the ‘data’ directory. Because the SEPEM data set is so large (every 5
minutes from 1974 to 2015 for RSDv2 and to 2017 for RSDv3), the program will
break up the data into yearly files for faster reading.</p>
<p>–NoInterp: Data sets are checked for bad data point (negative or None value
fluxes) and the default behavior is to fill in those bad data points by
performing a linear interpolation with time. This choice was made to
calculate more accurate event-intergrated fluence values from data.
Interpolation with time is not appropriate for model predictions, as
it will inherently change the prediction or may not be desired by
the user for the data set. Turn off interpolation with time by
setting the –NoInterp flag (or nointerp=True). If the interpolation
is turned off, negative flux values will be set to None.
Zeroes are always treated as valid values and are not replaced.
If there are gaps in the time steps, the code does NOT try to
fill in the gaps. It will ONLY perform interpolation for time
steps present in the input data set. i.e. gaps in time are not
interpolated, only time steps with negative or None flux values.</p>
<dl class="simple">
<dt>The values calculated here are important for space radiation operations:</dt><dd><p>Onset time, i.e. time to cross thresholds
Onset peak intensity
Onset peak time
Maximum intensity
Time of maximum intensity
Rise time (onset to peak)
End time, i.e. fall below 0.85*threshold for 3 points (15 mins for GOES)
Duration
Event-integrated fluences
Proton fluxes at various times after threshold crossing (UMASEP option)</p>
</dd>
</dl>
<p>UNITS: User may choose differential proton fluxes (e.g. [MeV s sr cm^2]^-1)
or integral fluxes (e.g. [s sr cm^2]^-1 or pfu). Default units are:
MeV, cm, s, sr
Units are specified in library/global_vars.py.
The program has no internal checks or requirements on units - EXCEPT FOR
THE THRESHOLD DEFINITIONS OF &gt;10, 10 and &gt;100, 1.
If you convert those thresholds in the main program to your units,
you should be able to generate consistent results.
Currently there are no features to change units automatically. SEE MORE
about units in the USER INPUT DATA section below.</p>
<p>OPTIONS: User may specify various options, that currently only apply to
GOES data:</p>
<blockquote>
<div><p>Choose corrected or uncorrected GOES fluxes.
Choose to apply Bruno (2017) or Sandberg et al. (2014) effective
energies to GOES uncorrected data.</p>
</div></blockquote>
<p>–options uncorrected
–options uncorrected,S14,Bruno2017 (recommend using background subtraction)</p>
<p>BACKGROUND SUBTRACTION: Users may choose to perform a background
subtraction by specifying:
–SubtractBG –BGStartDate YYYY-MM-DD –BGEndDate YYYY-MM-DD
The user should look at the data and select an appropriate time frame
prior to the event when the background is calm and well-defined. If
performing background subtraction, the mean background will be subtracted
from the fluxes in the SEP time frame (StartDate to EndDate). Plots
showing the mean background level, the background flux only, and the
background-subtracted SEP fluxes will be created by derive_background to
verify the quality of the background estimation and subtraction.</p>
<p>If a previous event is ongoing and the specified time period starts with a
threshold already crossed, you may try to set the –DetectPreviousEvent
flag. If the flux drops below threshold before the next event starts, the
program will identify the second event. This will only work if the
threshold is already crossed for the very first time in your specified
time period, and if the flux drops below threshold before the next event
starts.</p>
<p>If the event has an initial increase above threshold for a few points, falls
below threshold, then continues to increase above threshold again, you
may try to use the –TwoPeak feature to capture the full duration of the
event. The initial increase above threshold must be less than a day. An
example of this scenario can be seen in &gt;100 MeV for 2011-08-04.</p>
<p>A flag was added with the “UMASEP” option. When this flag is used
(–UMASEP), the code finds all information for four energy channels and
thresholds used by UMASEP: &gt;10 MeV, 10 pfu; &gt;100 MeV, 1 pfu; &gt;30 MeV, 1 pfu;
&gt;50 MeV, 1 pfu. The proton flux in each of these channels is reported for
multiple times after threshold crossing (Ts). The applied time delays are
as follows:</p>
<blockquote>
<div><p>&gt;10 MeV - Ts + 3, 4, 5, 6, 7 hours
&gt;30 MeV - Ts + 3, 4, 5, 6, 7 hours
&gt;50 MeV - Ts + 3, 4, 5, 6, 7 hours
&gt;100 MeV - Ts + 3, 4, 5, 6, 7 hours</p>
</div></blockquote>
<p>–spase_id: If you know the appropriate spase_id for the your model or
experiment, you may specify it here to be filled in to the json file
for CCMC’s SEP Scoreboard.</p>
<p>Note about EVENT END TIME: Currently, the code calculates the end of the
event as the first time that the flux drops below threshold*endfac for
three consecutive points. The endfac variable is specified in
library/global_vars.py.
Mimicking a SRAG code, endfac is set to 0.85 (85% of threshold). This
may be changed in the future to update this to more NOAA SWPC-like logic
to define the end of an SEP event.</p>
<p>RUN CODE FROM COMMAND LINE (put on one line), e.g.:
python3 operational_sep_quantities.py –StartDate 2012-05-17</p>
<blockquote>
<div><p>–EndDate “2012-05-19 12:00:00” –Experiment GOES-13
–FluxType integral –showplot –saveplot</p>
</div></blockquote>
<p>RUN CODE FROM COMMAND FOR USER DATA SET (put on one line), e.g.:
python3 operational_sep_quantities.py –StartDate 2012-05-17</p>
<blockquote>
<div><p>–EndDate ‘2012-05-19 12:00:00’ –Experiment user –ModelName MyModel
–UserFile MyFluxes.txt –FluxType integral –showplot</p>
</div></blockquote>
<p>RUN CODE FROM COMMAND LINE AND PERFORM BACKGROUND SUBTRACTION AND APPLY
Sandberg et al. (2014) and Bruno (2017) effective energies to the GOES bins.
(note: cannot bg-subtract GOES integral fluxes), e.g.:
python3 operational_sep_quantities.py –StartDate 2012-05-17</p>
<blockquote>
<div><p>–EndDate ‘2012-05-19 12:00:00’ –Experiment GOES-13
–FluxType differential  –showplot –options uncorrected,S14,Bruno2017
–SubtractBG –BGStartDate 2012-05-10 –BGEndDate –2012-05-17</p>
</div></blockquote>
<p>RUN CODE IMPORTED INTO ANOTHER PYTHON PROGRAM, e.g.:
import operational_sep_quantities as sep
start_date = ‘2012-05-17’
end_date = ‘2012-05-19 12:00:00’
experiment = ‘GOES-13’
flux_type = ‘integral’
spase_id = ‘’
model_name = ‘’ #if experiment is user, set model_name to describe data set
user_file = ‘’ #if experiment is user, specify filename containing fluxes
showplot = True  #Turn to False if don’t want to see plots
saveplot = False #turn to true if you want to save plots to file
options = ‘’ #various options: S14, Bruno2017, uncorrected
doBGSub = False #Set true if want to perform background subtraction
bgstart_date = “2012-05-10” #Dates used to estimate mean background if
bgend_date = “2012-05-17”   #doBGSub is set to True
detect_prev_event = True  #Helps if previous event causes high intensities
two_peaks = False  #Helps if two increases above threshold in one event
umasep = False #Set to true if want UMASEP values (see explanation above)
threshold = ‘’ #Add a threshold to 10,10 and 100,1: ‘30,1’ or ‘4.9-7.3,0.01’
nointerp = False #Default False; set to True to stop linear interpolatin in time</p>
<p>sep_year, sep_month,sep_day, jsonfname = sep.run_all(start_date,         end_date, experiment, flux_type, model_name, user_file,        spase_id, showplot, saveplot, detect_prev_event,          two_peaks, umasep, threshold, options, doBGSub, bgstart_date,         bgend_date,nointerp)</p>
<p>Set the desired directory locations for the data and output at the beginning
of the program in datapath and outpath. Defaults are ‘data’ and ‘output’.</p>
<p>In order to calculate the fluence, the program determines time_resolution
(seconds) by finding the difference between every consecutive set of
time points in the data set. The most common difference is identified as
the time resolution. This method should find an accurate time resolution
even if there are gaps in the time steps.
If the time steps in the data set are truly irregular, the user will
have to manually set the time resolution inside the subroutine
calculate_fluence.</p>
<p>OUTPUT: This program outputs 3 to 4 files, 1 per defined threshold plus
a summary file containing all of the values calculated for each threshold.
A file named as e.g. fluence_GOES-13_differential_gt10_2012_3_7.csv contains
the event-integrated fluence for each energy channel using the specified
threshold (gt10) to determine start and stop times.
A file named as e.g. sep_values_GOES-13_differential_2012_3_7.csv contains
start time, peak flux, etc, for each of the defined thresholds.</p>
<p>The program write to file the &gt;10 MeV and &gt;100 MeV time series for the
date range input by the user. If the original data were integral fluxes,
then the output files simply contain the &gt;10 and &gt;100 MeV time series from
the input files. If the original data were differential fluxes, then the
estimated &gt;10 and &gt;100 MeV fluxes are output as time series.</p>
<p>The program also writes any time profile to file if a threshold was applied
to it. Each energy channel is written to an independent file, named according
to CCMC’s SEP Scoreboard naming conventions. These accompany a json file
that contains all quantities calculated for the SEP event. There is also a csv
file that contains most of the same values recorded in the json file.</p>
<p>Example output for values derived from SEPMOD forecasts for the 2021-05-29
SEP event with additional threshold &gt;10, 0.001 pfu, &gt;100, 0.0001 pfu,
&gt;30 MeV, 1 pfu, &gt;50 MeV, 1 pfu, and &gt;60 MeV, 0.079 pfu. Some of the files
below are only created if a threshold was crossed. A default run would produce
only 10 and 100 MeV files, sep_values_*.csv and json file:
fluence_SEPMOD_RT_60min_integral_gt10_2021_5_29.csv
fluence_SEPMOD_RT_60min_integral_gt10.0_2021_5_29.csv
fluence_SEPMOD_RT_60min_integral_gt30.0_2021_5_29.csv
fluence_SEPMOD_RT_60min_integral_gt50.0_2021_5_29.csv
fluence_SEPMOD_RT_60min_integral_gt60.0_2021_5_29.csv
fluence_SEPMOD_RT_60min_integral_gt100.0_2021_5_29.csv
integral_fluxes_SEPMOD_RT_60min_integral_2021_5_29.csv
sep_values_SEPMOD_RT_60min_integral_2021_5_29.csv
SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.10.0MeV.txt
SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.10MeV.txt
SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.30.0MeV.txt
SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.50.0MeV.txt
SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.60.0MeV.txt
SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.100.0MeV.txt
SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.100MeV.txt
SEPMOD_RT_60min_integral.2021-05-29T000000Z.2021-08-06T172140Z.json</p>
<p>The json and txt files listed above would be the ones that would be appropriate
to read into the CCMC SEP Scoreboard or to pass to the SEP validation code
being developed in conjunction with the SEP Scoreboard. The csv files are legacy
files, but may also be easier for some users to read.</p>
<p>USER INPUT DATA SETS: Users may input their own data set. For example, if an
SEP modeler would like to feed their own intensity time series into this
code and calculate all values in exactly the same way they were calculated
for data, it is possible to do that. Default flux units are
1/[MeV cm^2 s sr] or 1/[cm^2 s sr] and energy channels in MeV for the default
thresholds to be correct. You can specify your units in the
library/global_vars.py file.</p>
<p>You can use any units, as long as you are consistent with energy units in
energy channel/bin definition and in fluxes and you MODIFY THE THRESHOLD
VALUES TO REFLECT YOUR UNITS. If you want to use different units, but
still have the correct operational definitions, you need to modify these
lines in define_thresholds() below:</p>
<blockquote>
<div><p>energy_thresholds = [10,100] #MeV; flux for particles of &gt; this MeV
flux_thresholds = [10,1] #pfu; exceed this level of intensity</p>
</div></blockquote>
<p>NOTE: The first column in your flux file is assumed to be time in format
YYYY-MM-DD HH:MM:SS. IMPORTANT FORMATTING!!
NOTE: The flux file may contain header lines that start with a hash #,
including blank lines.
NOTE: Any bad or missing fluxes must be indicated by a negative value.
NOTE: Put your flux file into the “datapath” directory. Filenames will be
relative to this path.
NOTE: Please use only differential or integral channels. Please do not mix
them. You may have one integral channel in the last bin, as this is the way
HEPAD works and the code has been written to include that HEPAD &gt;700 MeV
bin along with lower differential channels.</p>
<p>USER VARIABLES: The user must modify the following variables in
library/global_vars.py:</p>
<blockquote>
<div><dl class="simple">
<dt>user_col - identify columns in your file containing fluxes to analyze;</dt><dd><p>even if your delimeter is white space, consider the date-time
column as one single column. SET IN library/global_vars.py.</p>
</dd>
<dt>user_delim - delimeter between columns, e.g. ” ” or “,”   Use ” ” for</dt><dd><p>any amount of whitespace. SET IN library/global_vars.py.</p>
</dd>
<dt>user_energy_bins - define your energy bins at the top of the code in the</dt><dd><p>variable user_energy_bins. Follow the format in the subroutine
define_energy_bins. SET IN library/global_vars.py.</p>
</dd>
<dt>user_fname - specify the name of the file containing the fluxes</dt><dd><p>through an argument in the command line. –UserFile  The
user_fname variable will be updated with that filename. ARGUMENT</p>
</dd>
<dt>time_resolution - the program determines time_resolution</dt><dd><p>(seconds) by finding the difference between every consecutive
set of time points in the data set. The most common difference
is identified as the time resolution. This method should find
an accurate time resolution even if there are gaps in the
time steps.. AUTOMATICALLY DETERMINED.</p>
</dd>
</dl>
</div></blockquote>
<p>Running the code for a user-input file may look like the example below.
Note that the –UserFile location is with respect to the “data” directory
inside the operational-sep directory:
python3 operational_sep_quantities.py –StartDate 2021-05-29 –EndDate 2021-06-05 –Experiment user –UserFile SEPMOD/Scoreboard/SEPMOD.20210529_000000.20210529_165133.20210529_133005_geo_integral_tseries_timestamped_60min.txt –ModelName SEPMOD_RT_60min –showplot –Threshold “10,0.001;100,0.0001;30,1;50,1;60,0.079” –spase_id “spase://CCMC/SimulationModel/SEPMOD” –FluxType integral</p>
<dl>
<dt>VALUES SPECIFIED IN library/global_vars.py:</dt><dd><p>datapath - directory containing data, ‘data’
outpath - directory for program output, ‘output’
plotpath - directory for saving plots, ‘plots’
listpath - directory for lists (for run_multi_sep.py)
badval - will set any bad data points to this value
endfac - multiplicative factor to define threshold for</p>
<blockquote>
<div><p>end of event; threshold*endfac (default 0.85)</p>
</div></blockquote>
<dl class="simple">
<dt>nsigma - number of sigma to define SEP versus background</dt><dd><p>flux in background subtraction routine</p>
</dd>
<dt>version - if you are running a model or data set, allows you</dt><dd><p>to enter a version number</p>
</dd>
</dl>
<p>user_col - array defining flux columns (0 is always datetime)
user_delim - delimeter used to separate the columns in the time</p>
<blockquote>
<div><p>profile file that you will read in</p>
</div></blockquote>
<dl class="simple">
<dt>user_energy_bins - energy bins associated with the columns</dt><dd><p>specified in user_col</p>
</dd>
</dl>
<p>energy_units - e.g. “MeV’
flux_units_integral - e.g. “pfu”
fluence_units_integral - e.g. “cm^-2”
flux_units_differential - e.g. “MeV^-1*cm^-2*s^-1*sr^-1” (CCMC format)
fluence_units_differential - e.g. “MeV^-1*cm^-2” (CCMC format)</p>
<p>(setting the units here will make correct units on plots and in json
file, but doesn’t change operational threshold values; must be done
accordingly by hand)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.append_differential_thresholds">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">append_differential_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_diff_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plt_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plt_flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detect_prev_event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_threshold_fluences</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_fluence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_energies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rise_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_peak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_fluxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.append_differential_thresholds" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the threshold crossing information for differential channels
as specified by the user.</p>
<p>Definitions:
n integral energy thresholds (&gt;10, &gt;100 + user input integral</p>
<blockquote>
<div><p>thresholds)</p>
</div></blockquote>
<p>m energy bins associated with the input flux files
p user input thresholds (integral + differential, define</p>
<blockquote>
<div><p>d differential channels for which a threshold is applied
n-2 = integral channels, (n-2)+d = p)</p>
</div></blockquote>
<dl class="simple">
<dt>q time points in the flux time profiles (between user input</dt><dd><p>start and end dates)</p>
</dd>
</dl>
<p>INPUTS (filled in up to thresholds applied to integral channels):
energy_thresholds (float 1xn array) - energy channels for which a</p>
<blockquote>
<div><p>threshold is applied (at this point, only the integral ones)</p>
</div></blockquote>
<dl class="simple">
<dt>flux_thresholds (float 1xn array) - flux thresholds applied to</dt><dd><p>the energy channels in energy_thresholds</p>
</dd>
<dt>str_thresh (string 1xp array) - p user input thresholds broken into</dt><dd><p>an array (need for generating plot labels)</p>
</dd>
<dt>is_diff_thresh (bool 1xp array) - indicates which of the user</dt><dd><p>thresholds are applied to differential channels</p>
</dd>
<dt>plt_energy (float 1xn array) - holds energy thresholds for the</dt><dd><p>integral channels at this point</p>
</dd>
<dt>plt_flux (float 1xn array) - hold the flux thresholds for the</dt><dd><p>integral channels at this point</p>
</dd>
<dt>input_threshold (float 2xp array) - p input thresholds in form</dt><dd><p>[binlowedge, flux threshold]</p>
</dd>
<dt>energy_bins (float 2xm array) - m energy bins for each input</dt><dd><p>flux channel</p>
</dd>
</dl>
<p>dates (datetime 1xq array) - q time points for the flux time profile
fluxes (float mxq array) - flux time profiles for m energy bins and</p>
<blockquote>
<div><p>q time points</p>
</div></blockquote>
<p>detect_prev_event (bool) - option for finding start of event
two_peaks (bool) - option for extending event length
umasep (boolean) - indicate if user called UMASEP flag
umasep_times (datetime 5xn array) - times 3, 4, 5, 7, 9 hours after</p>
<blockquote>
<div><p>crossing time for each applied threshold</p>
</div></blockquote>
<dl class="simple">
<dt>umasep_fluxes (float 5xn) - fluxes at each of those times for each</dt><dd><p>applied threshold</p>
</dd>
<dt>all_threshold_fluences (float 1xn array) - fluence values for integral</dt><dd><p>or estimated integral fluxes in the n energy channels for which
thresholds were applied</p>
</dd>
<dt>all_fluence (float nxm array) - fluence spectrum in the original</dt><dd><p>integral or differential energy channels associated with
energy_bins. Fluence calculated between crossing_time and
event_end_time, so this is the fluence spectrum associated with
the events defined by the thresholds applied to each energy channel</p>
</dd>
<dt>all_energies (float 1xm array) - effective energies for energy_bins,</dt><dd><p>defined by sqrt(low bin edge*high bin edge)</p>
</dd>
<dt>crossing_time (datetime 1xn array) - SEP event start time for each</dt><dd><p>applied threshold</p>
</dd>
</dl>
<p>peak_flux (float 1xn array) - maximum flux for each applied threshold
peak_time (datetime 1xn array) - time of maximum flux for each applied</p>
<blockquote>
<div><p>threshold</p>
</div></blockquote>
<p>rise_time (timedelta 1xn array) - start time to max flux
event_end_time (datetime 1xn array) - end time for each applied threshold
duration (timedelta 1xn array) - end time minus start time
onset_peak (float 1xn array) - onset peak for each applied threshold
onset_date (datetime 1xn array) - onset peak time for each applied</p>
<blockquote>
<div><p>threshold</p>
</div></blockquote>
<dl class="simple">
<dt>integral_fluxes (float nxq array) - flux time profiles of integral</dt><dd><p>or estimated integral fluxes for n energy channels and m time steps</p>
</dd>
</dl>
<p>OUTPUTS:
(thresholds applied to differential channels have been
appended; define d as the number of differential channels for
which the user applied a threshold.
n+d = total number of thresholds applied to energy channels):</p>
<p>energy_thresholds (float 1x(n+d) array)
flux_thresholds (float 1x(n+d) array)
plot_diff_thresh (bool 1x(n+d) array)
plt_energy (float 1x(n+d) array)
plt_flux (float 1x(n+d) array)
all_threshold_fluences (float 1x(n+d) array)
all_fluence (float (n+d)xm array)
all_energies (float 1xm array)
crossing_time (datetime 1x(n+d) array)
peak_flux (float 1x(n+d) array)
peak_time (datetime 1x(n+d) array)
rise_time (timedelta 1x(n+d) array)
event_end_time (datetime 1x(n+d) array)
duration (timedelta 1x(n+d) array)
onset_date (datetime 1x(n+d) array)
onset_peak (float 1x(n+d) array)
integral_fluxes (float (n+d)xq array)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.calculate_event_info">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">calculate_event_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detect_prev_event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_thresh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.calculate_event_info" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Applies energy and flux thresholds to calculate SEP event quantities:</dt><dd><p>Threshold crossing time (onset)
Peak Flux in date range specified by user
Time of Peak Flux
Rise Time (onset to peak flux)
Event End Time (below 0.85*threshold for 3 data points, e.g 15 min)
Duration (onset to end)</p>
</dd>
</dl>
<p>If the detect_prev_event flag is set to true and the threshold is crossed
on the first time in the specified date range, this indicates that fluxes
were already high due to a previous event. The code will look for the
flux to drop below threshold and then increase above threshold again
during the specified time period. If this flag is not set, then the code
simply take the first threshold crossing as the start of the SEP event.</p>
<p>If the two_peaks flag is set to true, the code will use the first
identified threshold crossing as the start time. A second threshold
crossing will be allowed. The event end will be determined as the drop
below threshold after the second threshold crossing. The duration will
be the end time - first threshold crossing time. The peak will be
determined as the largest flux value found in both threshold crossings.
The peak and rise times will be calculated from the first threshold
crossing time.</p>
<p>NOTE: integral_fluxes is a “historic” name and may actual contain
integral or differential fluxes. They correspond to the flux channels
for which a threshold has been applied.</p>
<p>INPUTS:
energy_thresholds (float 1xn array) - energy channels for which a</p>
<blockquote>
<div><p>threshold is applied</p>
</div></blockquote>
<p>flux_thresholds (float 1xn array) - flux thresholds to apply
dates (datetime 1xm array)
integral_fluxes (float nxm array) - fluxes only associated with the</p>
<blockquote>
<div><p>energy channels in energy_thresholds</p>
</div></blockquote>
<p>detect_prev_event (boolean)
two_peaks (boolean)
diff_thresh (boolean) - indicates if the energy_threshold and</p>
<blockquote>
<div><p>flux_threshold refer to a differential channel (True)</p>
</div></blockquote>
<p>OUTPUTS:
crossing_time (datetime 1xn array) - crossing times for n applied thresholds
peak_flux (float 1xn array) - max flux value between start and end time
peak_time (datetime 1xn array)
rise_time (timedelta 1xn array) - (peak_time - crossing_time)
event_end_time (datetime 1xn array)
duration (timedelta 1xn arrat) - (event_end_time - crossing_time)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.calculate_fluence">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">calculate_fluence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.calculate_fluence" title="Permalink to this definition">¶</a></dt>
<dd><p>This subroutine sums up all of the flux in the 1xn array “flux”. The
“dates” and “flux” arrays input here should reflect only the intensities
between the SEP start and stop times, determined by the subroutine
calculate_threshold_crossing. The subroutine does not differentiate between
differential or integral flux.</p>
<p>The extract_date_range subroutine is used prior to calling this one to
make the dates and fluxes arrays covering only the SEP time period.
The flux will be multiplied by time_resolution and summed for all of the
data between the start and end times. Negative or bad flux values
should have been set to None or interpolated with check_bad_data().
None values will be skipped.</p>
<p>The time resolution is found by taking the difference between
every consecutive data point. The most common difference is
taken as the time resolution. Even if the data set has gaps,
if there are enough consecutive time points in the observational
or model output, the correct time resolution should be identified.</p>
<p>Fluence units will be 1/[MeV cm^2] for GOES or SEPEM differential
fluxes or 1/[cm^2] for integral fluxes.</p>
<p>INPUTS:
flux (float 1xn array) - intensity time series for a single energy bin</p>
<blockquote>
<div><p>or single integral channel (1D array).</p>
</div></blockquote>
<p>dates (datetime 1xn array) - datetimes that correspond to the fluxes</p>
<p>OUTPUTS:
fluence (float) - sum of all the flux values in flux</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.calculate_integral_fluences">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">calculate_integral_fluences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_threshold_fluences</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_fluence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_energies</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.calculate_integral_fluences" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate fluence values for all integral energy thresholds
between start and end times determined in each channel.
This subroutine is only called for the thresholds applied
to integral channels.</p>
<p>INPUTS:
experiment (string)
flux_type (string) - integral, differential
options (string array) - options that could be applied
model_name (string) - model name or experiment if experiment = “user”
doBGSub (bool) - indicate if background subtraction to be performed
startdate (datetime) - start date of time period entered by user
enddate (datetime) - end date of time period entered by user
energy_bins (float 2xp array) - energy bins for all of the flux channels
energy_thresholds (float 1xn array) - energy channels for which a</p>
<blockquote>
<div><p>threshold is applied (at this point, only the integral ones)</p>
</div></blockquote>
<dl class="simple">
<dt>flux_thresholds (float 1xn array) - flux thresholds applied to</dt><dd><p>the energy channels in energy_thresholds</p>
</dd>
</dl>
<p>dates (datetime 1xm array) - time points for the flux time profiles
fluxes (float pxm array) - flux time profiles for p energy bins and m</p>
<blockquote>
<div><p>time steps</p>
</div></blockquote>
<dl class="simple">
<dt>integral_fluxes (float nxm array) - flux time profiles of integral</dt><dd><p>or estimated integral fluxes for n energy channels and m time steps</p>
</dd>
<dt>crossing_time (datetime 1xn array) - SEP event start times for each</dt><dd><p>energy channel with an applied threshold</p>
</dd>
<dt>event_end_time (datetime 1xn array) - SEP event end times for each</dt><dd><p>energy channel with an applied threshold</p>
</dd>
<dt>all_threshold_fluences (float 1xn array) - fluence values for integral</dt><dd><p>or estimated integral fluxes in the n energy channels for which
thresholds were applied</p>
</dd>
<dt>all_fluence (float nxp array) - fluence spectrum in the original</dt><dd><p>integral or differential energy channels associated with
energy_bins. Fluence calculated between crossing_time and
event_end_time, so this is the fluence spectrum associated with
the events defined by the thresholds applied to each energy channel</p>
</dd>
<dt>all_energies (float 1xp array) - effective energies for energy_bins,</dt><dd><p>defined by sqrt(low bin edge*high bin edge)</p>
</dd>
</dl>
<p>OUTPUTS:
Arrays filled in for the integral thresholds:
all_threshold_fluences (float 1xn array) - fluence values for integral</p>
<blockquote>
<div><p>or estimated integral fluxes in the n energy channels for which
thresholds were applied</p>
</div></blockquote>
<dl class="simple">
<dt>all_fluence (float nxp array) - fluence spectrum in the original</dt><dd><p>integral or differential energy channels associated with
energy_bins. Fluence calculated between crossing_time and
event_end_time, so this is the fluence spectrum associated with
the events defined by the thresholds applied to each energy channel</p>
</dd>
<dt>all_energies (float 1xp array) - effective energies for energy_bins,</dt><dd><p>defined by sqrt(low bin edge*high bin edge)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.calculate_onset_peak">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">calculate_onset_peak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplot</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.calculate_onset_peak" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the peak associated with the initial SEP onset. This subroutine
searches for the rollover that typically occurs after the SEP onset.
The peak value will be specified as the flux value at the rollover
location.
If the event peak is larger than 500/energy channel (e.g. for &gt;10
MeV, if peak is above 50 pfu), then the rollover will be found
starting from the threshold crossing time.
If the event is a “weaker” event with a maximum below the value above,
the rollover location will be identified starting from 12 hours
prior to threshold crossing time. The onset peak time may be BEFORE
THE EVENT START TIME with this logic, but is more independent of the
level of the threshold and more linked to the behavior of the flux
time profile.
The onset peak may provide a more physically appropriate comparison
with models.
If code cannot identify onset peak, it will return a value of 0 on
the date None.</p>
<p>INPUTS:
experiment (string) e.g. GOES-13
energy_thresholds (float 1xn array) - energy channels for which thresholds</p>
<blockquote>
<div><p>are applied</p>
</div></blockquote>
<p>dates (datetime 1xm array) - dates associated with flux time profile
integral_fluxes (float nxm array) - fluxes for each energy channel for</p>
<blockquote>
<div><p>which a threshold is applied; each is the same length as dates</p>
</div></blockquote>
<dl class="simple">
<dt>crossing_time (datetime 1xn array) - threshold crossing times for each energy</dt><dd><p>channel for which a threshold is applied</p>
</dd>
<dt>event_end_time (datetime 1xn array) - end times for each energy channel for which</dt><dd><p>a threshold is applied</p>
</dd>
</dl>
<p>showplot (bool)</p>
<p>OUTPUTS:
onset_date (datetime 1xn array) - time of onset peak
onset_peak (float 1xn array) - flux value of onset peak</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.calculate_threshold_crossing">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">calculate_threshold_crossing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.calculate_threshold_crossing" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the time that a threshold is crossed.
Operational thresholds used by the NASA JSC Space Radiation Analysis
Group to determine actions that should be taken during an SEP event are:</p>
<blockquote>
<div><p>&gt;10 MeV proton flux exceeds 10 pfu (1/[cm^2 s sr])
&gt;100 MeV proton flux exceeds 1 pfu (1/[cm^2 s sr])</p>
</div></blockquote>
<p>An SEP event is considered to start if 3 consecutive points are
above threshold. The start time is set to the first point that crossed
threshold.</p>
<p>Values are calcualated for any additional thresholds provided by user.</p>
<p>This program also calculates peak flux and time of peak flux for time
period specified by user. It then calculates rise time by comparing:
rise time = time of peak flux - threshold crossing time
If no thresholds are crossed during specified time period, peak time
and rise time will be 0.
The event end time is much more subjective. For this program, I follow
the code that officially calls the end of an event when SRAG supports
ISS operations. When the flux has three consecutive points (15 minutes
of GOES data) below 0.85*threshold, then the event is ended. The end time
is corrected back to the first of the three data points. This end
criteria has no physics basis. It simply ensures that a new event will
not erroneously begin within the SRAG SEP alarm code due to flux
fluctuations around threshold as the SEP flux decays away slowly.
If the time period specified by the user ends before the event falls
below 0.85*threshold, then the event_end_time is set to the last time
in the specified time range. The program will give a message indicating
that the user may want to extend the requested time frame in order to
better-capture the end of the event.</p>
<p>INPUTS:
energy_threshold (float) - energy channel for which the</p>
<blockquote>
<div><p>flux threshold value should be applied</p>
</div></blockquote>
<p>flux_threshold (float) - flux threshold value
dates (datetime 1xn array) - dates associated with the flux time profile
fluxes (float 1xn array) - flux with time for the single energy channel</p>
<blockquote>
<div><p>associated with energy_threshold</p>
</div></blockquote>
<p>OUTPUTS:
crossing_time (datetime)
peak_flux (float) - maximum flux value between start and end time
peak_time (datetime)
rise_time (timedelta) - (peak_time - crossing_time)
event_end_time (datetime)
duration (timedelta) - (event_end_time - crossing_time)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.calculate_umasep_info">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">calculate_umasep_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.calculate_umasep_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the integral fluxes (either input or estimated from differential
channels) and all the energy and flux thresholds set in the main program
to calculate SEP event quantities specific to the UMASEP model.</p>
<blockquote>
<div><p>Flux at threshold crossing time + 3, 4, 5, 6, 7 hours</p>
</div></blockquote>
<p>INPUTS:
energy_thresholds (float 1xn array) - energy channels for which thresholds</p>
<blockquote>
<div><p>are applied</p>
</div></blockquote>
<p>flux_thresholds (float 1xn array) - flux thresholds that are applied
dates (datetime 1xm array) - dates associated with flux time profile
integral_fluxes (float nxm array) - fluxes for each energy channel for</p>
<blockquote>
<div><p>which a threshold is applied; each is the same length as dates</p>
</div></blockquote>
<dl class="simple">
<dt>crossing_time (datetime 1xn array) - threshold crossing times for each energy</dt><dd><p>channel for which a threshold is applied</p>
</dd>
</dl>
<p>OUTPUTS:
proton_delay_times (datetime nx5 array) - times 3, 4, 5, 6, 7 hours</p>
<blockquote>
<div><p>after crossing time for n thresholds</p>
</div></blockquote>
<dl class="simple">
<dt>proton_flux (float nx5 array) - value of flux at each delay time and for</dt><dd><p>each threshold</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.check_bin_exists">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">check_bin_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.check_bin_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>If a user specifies a threshold for a differential energy bin, check
to see that the energy bin is in the requested data set.
threshold is a list of strings.
Expect threshold[0] = lowedge-highedge, threshold[1] = flux value</p>
<p>INPUTS:
threshold (string) - threshold input by user in string format
energy_bins (float 2xn array) - energy bins for n energy channels</p>
<p>OUTPUTS:
Boolean indicating specified bins exist, or exit</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.consistent_peak_fluxes">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">consistent_peak_fluxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_peak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.consistent_peak_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>If a threshold is not crossed, then the max flux is saved
as zero and the onset peak is saved as the maximum value
in the time range considered. This is technically
not correct.
Swapping the two values to more correct.</p>
<p>INPUTS (for n SEP events):
crossing_time (datetime 1xn array) - value will be zero</p>
<blockquote>
<div><p>if no threshold was crossed</p>
</div></blockquote>
<dl class="simple">
<dt>onset_peak (float 1xn array) - value of onset peak for each</dt><dd><p>SEP event, max flux if no thresholds crossed</p>
</dd>
</dl>
<p>onset_date (datetime 1xn array) - time of onset peaks
peak_flux (float 1xn array) - values of maximum flux for</p>
<blockquote>
<div><p>each SEP event, zero if no threshold crossed</p>
</div></blockquote>
<dl class="simple">
<dt>peak_time (datetime 1xn array) - value of peak flux, zero if</dt><dd><p>threshold not crossed</p>
</dd>
</dl>
<p>OUTPUTS (same as above, but values switched around):
onset_peak - value set to zero if no threshold crossed
onset_date - value set to zero if no threshold crossed
peak_flux - value of max flux during time period
peak_time - time of max flux</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.define_thresholds">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">define_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_diff_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.define_thresholds" title="Permalink to this definition">¶</a></dt>
<dd><p>Two operational thresholds plus any thresholds
specified by the user.</p>
<p>INPUTS:
input_threshold (float 2xn array) - thresholds specified by user e.g.</p>
<blockquote>
<div><p>[[30,1],[50,1]]</p>
</div></blockquote>
<dl class="simple">
<dt>is_diff_thresh (bool 1xn array) - indicates whether the input threshold</dt><dd><p>is a differential channel</p>
</dd>
<dt>str_thresh (string) - threshold as input by user in command line e.g.</dt><dd><p>“30,1;50,1;4.9-8.3,10”</p>
</dd>
</dl>
<p>OUTPUTS:
energy_thresholds (float 1x(n+2) array) - e.g. [10,100,30,50,4.9]</p>
<blockquote>
<div><p>energy channels for which a threshold will be applied. Includes
the two operational thresholds plus any thresholds entered by
the user</p>
</div></blockquote>
<dl class="simple">
<dt>flux_thresholds (float 1x(n+2) array) - e.g. [10,1,1,1,10]</dt><dd><p>flux thresholds to be applied to the energy channels in
energy_thresholds. Includes the two operational thresholds
plus any thresholds entered by the user</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.determine_time_resolution">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">determine_time_resolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dates</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.determine_time_resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>The time resolution is found by taking the difference between
every consecutive data point. The most common difference is
taken as the time resolution. Even if the data set has gaps,
if there are enough consecutive time points in the observational
or model output, the correct time resolution should be identified.</p>
<p>INPUTS:
dates (datetime 1xm array) - dates associated with flux time profile</p>
<p>OUTPUTS:
time_resolution (time delta object)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.error_check_inputs">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">error_check_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">startdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_diff_thresh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.error_check_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that all of the user inputs make sense and fall within bounds.</p>
<p>INPUTS:
startdate (datetime) - start of time period entered by user
enddate (datetime) - end of time period entered by user
experiment (string) - name of experiment specifed by user
flux_type (string) - integral or differential
is_diff_thresh (bool 1xn array) - where n indicates the number of</p>
<blockquote>
<div><p>thresholds input by the user, e.g. “30,1;50,1” n=2
Indicates if the user-input thresholds apply to integral or
differential channels</p>
</div></blockquote>
<p>OUTPUTS:
None, but system exit if error found</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.error_check_options">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">error_check_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.error_check_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Make sure the selected options make sense for the experiment.
INPUTS:
experiment (string)
flux_type (string) - integral or differential
options (string array) - various options applied to GOES data
doBGSub (boolean) - indicates if background subtraction to be</p>
<blockquote>
<div><p>performed</p>
</div></blockquote>
<p>OUTPUTS:
no outputs by system exit if error found</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.extract_integral_fluxes">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">extract_integral_fluxes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.extract_integral_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Select or create the integral fluxes that correspond to the desired
energy thresholds.
If the user selected differential fluxes, then the
differential fluxes will be converted to integral fluxes with the
minimum energy defined by the set energy thresholds.
If the user selected integral fluxes, then the channels corresponding to
the desired energy thresholds will be identified.
If an energy channel with a specified is not present, will return a
None value for the integral fluxes, and remove that threshold in
run_all. (e.g. if &gt;100 MeV fluxes were not in the data or model
fluxes, return a None value for integral fluxes and remove the
&gt;100 MeV, 1 pfu threshold.)</p>
<p>INPUTS:
fluxes (float nxm array) - flux time profile for each energy channel
experiment (string)
flux_type (string) - integral or differential
flux_thresholds (float 1xp array) - flux threshold values
energy_thresholds (float 1xp array) - energy channels to which the</p>
<blockquote>
<div><p>flux threshold values are applied</p>
</div></blockquote>
<p>energy_bins (float 1xn array) - bins for each energy channel in fluxes
options (string array) - bg subtraction, effective energies for</p>
<blockquote>
<div><p>GOES channels</p>
</div></blockquote>
<p>OUTPUTS:
integral_fluxes (float array) - integral fluxes associated with each</p>
<blockquote>
<div><p>energy channel in energy_thresholds; &gt;energy_thresholds[i]</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.from_differential_to_integral_flux">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">from_differential_to_integral_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.from_differential_to_integral_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>If user selected differential fluxes, convert to integral fluxes to
caluculate operational threshold crossings (&gt;10 MeV protons exceed 10
pfu, &gt;100 MeV protons exceed 1 pfu).
Assume that the measured fluxes correspond to the center of the energy
bin and use power law interpolation to extrapolate integral fluxes
above user input min_energy.
The intent is to calculate &gt;10 MeV and &gt;100 MeV fluxes, but leaving
flexibility for user to define the minimum energy for the integral flux.
An integral flux will be provided for each timestamp (e.g. every 5 mins).</p>
<p>INPUTS:
experiment (string)
min_energy (float) - bottom energy for integral flux calculation
energy_bins (float 1xn array) - bins for each energy channel
fluxes (float nxm array) - fluxes with time for each energy channel
options (string array) - effective energies for GOES channels</p>
<p>OUTPUTS:
integral_fluxes (float 1xm array) - estimate integral flux for &gt;min_energy</p>
<blockquote>
<div><p>(Returns all zero values if no energy bins above min_energy)</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.get_energy_bin_index">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">get_energy_bin_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.get_energy_bin_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the index associated with the integral or differential energy bin, check
to see that the energy bin is in the requested data set.
threshold is a list of strings.
For integral, expect:</p>
<blockquote>
<div><p>energy_threshold = lowedge</p>
</div></blockquote>
<dl class="simple">
<dt>For differential, expect:</dt><dd><p>energy_threshold[0] = lowedge
energy_threshold[1] = highedge</p>
</dd>
</dl>
<p>INPUTS:
energy_threshold (float or 1x2 array)
energy_bins (float 2xn array) - energy bins for n energy channels</p>
<p>OUTPUTS:
index (integer) - index of energy bin associated with energy_threshold</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.get_fluence_spectrum">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">get_fluence_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.get_fluence_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the fluence spectrum for each of the energy channels in the
user selected data set. If the user selected differential fluxes, then
the fluence values correspond to each energy bin. If the user selected
integral fluxes, then the fluence values correspond to each integral bin.
Writes fluence values to file according to boolean save_file.
If the user input a threshold for a differential energy bin,
is_diff_thresh will be true and the filename will not contain “gt”.</p>
<p>INPUTS:
experiment (string)
flux_type (string) - integral or differential
options (string array) - bg subtraction, effective energies for</p>
<blockquote>
<div><p>GOES channels</p>
</div></blockquote>
<p>model_name (string) - name of model or user experiment, if relevant
energy_threshold (float) - energy channel to which the</p>
<blockquote>
<div><p>flux threshold value is applied</p>
</div></blockquote>
<p>flux_threshold (float) - flux threshold value
sep_dates (datetime 1xm array) - dates trimmed between SEP start and</p>
<blockquote>
<div><p>end times</p>
</div></blockquote>
<dl class="simple">
<dt>sep_fluxes (float nxm array) - flux time profiles for each energy channel</dt><dd><p>trimmed between SEP start and end times</p>
</dd>
</dl>
<p>energy_bins (float 1xn array) - bins for each energy channel
diff_thresh (boolean) - indicates if the energy_threshold and</p>
<blockquote>
<div><p>flux_threshold refer to a differential channel (True)</p>
</div></blockquote>
<p>save_file (boolean) - set True to save fluence values to file</p>
<p>OUTPUTS:
fluence (float 1xn array) - fluence value in each energy bin
energies (float 1xn array) - bin centers for each energy bin</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.get_input_thresholds">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">get_input_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">str_thresh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.get_input_thresholds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get user specified input thresholds,
INPUTS:
str_thresh (string) input by user with thresholds</p>
<blockquote>
<div><p>separated by semi-colons</p>
</div></blockquote>
<p>OUTPUTS:
input_threshold (2xn floats) array as</p>
<blockquote>
<div><dl class="simple">
<dt>[[binLow, flux threshold],</dt><dd><p>[bin Low, fluxthreshold],
…]</p>
</dd>
</dl>
</div></blockquote>
<p>is_diff_thresh (bool array)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.print_values_to_file">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">print_values_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_peak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rise_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_fluences</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_diff_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep_fluxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.print_values_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write all calculated values to file for all thresholds. Event-integrated
fluences for &gt;10, &gt;100 MeV (and user-defined threshold) will also be
included. Writes out file with name e.g.
output/sep_values_experiment_fluxtype_YYYY_M_D.csv
If the UMASEP option was selected, add on the proton values calculated
at the UMASEP Ts + Xhr time points.
is_diff_thresh indicates whether the user input a differential
threshold. If so, the user threshold bin(s) will refer to differential
fluxes.</p>
<p>Writes all values out to a csv file. These values and more are also
written out to json file in a different subroutine.</p>
<p>INPUTS:
experiment (string)
flux_type (string) - integral or differential
options (string array) - can be S14, Bruno2017, uncorrected and apply</p>
<blockquote>
<div><p>to GOES data</p>
</div></blockquote>
<p>doBGSub (boolean) - indicates if background subtraction performed
model_name (string) - model or experiment name if experiment = “user”
startdate (datetime) - start date of time period entered by user
energy_thresholds (float 1xn array) - all energy channels for which</p>
<blockquote>
<div><p>a flux threshold was applied (both integral and differential)</p>
</div></blockquote>
<dl class="simple">
<dt>flux_thresholds (float 1xn array) - flux thresholds for each of the</dt><dd><p>energy channels in energy_thresholds</p>
</dd>
<dt>crossing_time (datetime 1xn array) - SEP event start time for each</dt><dd><p>applied threshold</p>
</dd>
</dl>
<p>onset_peak (float 1xn array) - onset peak for each applied threshold
onset_date (datetime 1xn array) - onset peak time for each applied</p>
<blockquote>
<div><p>threshold</p>
</div></blockquote>
<p>peak_flux (float 1xn array) - maximum flux for each applied threshold
peak_time (datetime 1xn array) - time of maximum flux for each applied</p>
<blockquote>
<div><p>threshold</p>
</div></blockquote>
<p>rise_time (timedelta 1xn array) - start time to max flux
event_end_time (datetime 1xn array) - end time for each applied threshold
duration (timedelta 1xn array) - end time minus start time
threshold_fluences (float 1xn array) - event fluence for each energy</p>
<blockquote>
<div><p>channel in energy_thresholds</p>
</div></blockquote>
<dl class="simple">
<dt>is_diff_thresh (bool 1xn array) - indicates if threshold applied to</dt><dd><p>integral or differential channel, e.g. if channel in energy_thresholds
is an integral or differential channel</p>
</dd>
</dl>
<p>umasep (boolean) - indicate if user called UMASEP flag
umasep_times (datetime 5xn array) - times 3, 4, 5, 6, 7, 9 hours after</p>
<blockquote>
<div><p>crossing time for each applied threshold</p>
</div></blockquote>
<dl class="simple">
<dt>umasep_fluxes (float 5xn) - fluxes at each of those times for each</dt><dd><p>applied threshold</p>
</dd>
</dl>
<p>OUTPUTS:
year (integer) - year of either SEP event or startdate (if no</p>
<blockquote>
<div><p>thresholds crossed)</p>
</div></blockquote>
<dl class="simple">
<dt>month (integer) - month of either SEP event or startdate (if no</dt><dd><p>thresholds crossed)</p>
</dd>
<dt>day (integer) - day of either SEP event or startdate (if no</dt><dd><p>thresholds crossed)</p>
</dd>
<dt>Output file named e.g.</dt><dd><p>output/sep_values_experiment_fluxtype_YYYY_M_D.csv</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.read_in_flux_files">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">read_in_flux_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_startdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_enddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_bgstartdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_bgenddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nointerp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveplot</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.read_in_flux_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Read in the appropriate data or user files. Performs
background subtraction, if requested. Trims to dates
between start time and end time. Interpolates bad
points with linear interpolation in time.</p>
<p>INPUTS:
experiment (string)
flux_type (string) - integral, differential
user_file (string) - file containing user’s flux time profiles
model_name (string) - model name or experiment if experiment = “user”
startdate (datetime) - start date of time period entered by user
enddate (datetime) - end date of time period entered by user
str_startdate (string) - start date in string form
str_enddate (string) - end date in string form
str_bgstartdate (string) - start date of time period to be used for</p>
<blockquote>
<div><p>background subtraction</p>
</div></blockquote>
<dl class="simple">
<dt>str_bgenddate (string) - end date of time period to be used or</dt><dd><p>background subtraction</p>
</dd>
</dl>
<p>options (string array) - options that could be applied
doBGSub (bool) - indicate if background subtraction to be performed
nointerp (bool) - indicates if user doesn’t want to do linear</p>
<blockquote>
<div><p>interpolation in time for negative of bad flux values</p>
</div></blockquote>
<p>showplot (bool)
saveplot (bool) - save plots automatically to “plots” directory</p>
<p>OUTPUTS:
dates (datetime 1xm array) - times in flux time profile trimmed</p>
<blockquote>
<div><p>between startdate and enddate</p>
</div></blockquote>
<dl class="simple">
<dt>fluxes (numpy float nxm array) - fluxes for n energy channels and m</dt><dd><p>time steps; these are background subtracted fluxes if background
subtraction was selected.</p>
</dd>
</dl>
<p>energy_bins (array nx2 for n thresholds)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.report_threshold_fluences">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">report_threshold_fluences</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_fluxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.report_threshold_fluences" title="Permalink to this definition">¶</a></dt>
<dd><p>Report fluences for specified thresholds, typically &gt;10, &gt;100 MeV.
These values are interesting to use for comparison with literature and
for quantifying event severity.</p>
<p>Assumes that energy_thresholds are referring to integral energy
channels.
Assumes that sep_fluxes are integral or estimated integral
fluxes for each energy channel in energy_thresholds.
If the input fluxes were differential, then this subroutine only
works correctly for integral energy_thresholds and matching sep_fluxes
that were estimated for each integral channel in energy_thresholds.</p>
<p>INPUTS:
experiment (string)
flux_type (string) - integral or differential
model_name (string) - name of model or experiment if experiment = “user”
energy_thresholds (float 1xn array) - integral energy channels for</p>
<blockquote>
<div><p>which a threshold has been applied</p>
</div></blockquote>
<p>energy_bins (float 2xm array) - energy bins for input fluxes
sep_dates (datetime 1xp array) - time profile dates trimmed to</p>
<blockquote>
<div><p>start and stop of SEP event</p>
</div></blockquote>
<dl class="simple">
<dt>sep_fluxes (float mxp array) - flux time profiles for each energy</dt><dd><p>channel trimmed to start and end dates</p>
</dd>
</dl>
<p>OUTPUTS:
integral_fluence (float 1xn array) - event fluence for all</p>
<blockquote>
<div><p>integral energy channels for which a threshold was applied</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.run_all">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">run_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">str_startdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_enddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spase_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showplot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveplot</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detect_prev_event</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_peaks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_bgstartdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_bgenddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nointerp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.run_all" title="Permalink to this definition">¶</a></dt>
<dd><p>“Runs all subroutines and gets all needed values. Takes the command line
arguments as input. Code may be imported into other python scripts and
run using this routine.</p>
<p>INPUTS:
str_startdate (string) - user input start date “YYYY-MM-DD” or</p>
<blockquote>
<div><p>“YYYY-MM-DD HH:MM:SS”</p>
</div></blockquote>
<dl class="simple">
<dt>str_enddate (string) - user input end date “YYYY-MM-DD” or</dt><dd><p>“YYYY-MM-DD HH:MM:SS”</p>
</dd>
<dt>experiment (string) - “GOES-08” up to “GOES-15”, “SEPEM”, “SEPEMv3”,</dt><dd><p>“EPHIN”, “EPHIN_REleASE”, or “user”</p>
</dd>
<dt>flux_type (string) - “integral” or “differential” indicates the type</dt><dd><p>of flux to read in</p>
</dd>
<dt>model_name (string) - If model is “user”, set model_name to describe</dt><dd><p>your model or data set (e.g. MyModel), otherwise set to ‘’.</p>
</dd>
<dt>user_file (string) - Default is ‘’. If “user” is selected for experiment,</dt><dd><p>specify name of flux file.</p>
</dd>
<dt>spase_id (string) - Default is ‘’. If you know the spase_id of you</dt><dd><p>model or experiment, enter it here for the json file</p>
</dd>
</dl>
<p>showplot (bool) - Set to True to show plots when run
saveplot (bool) - Set to True to automatically save plots to the</p>
<blockquote>
<div><p>plots directory when run</p>
</div></blockquote>
<p>detect_prev_event (bool) - option for finding start of event
two_peaks (bool) - option for extending event length
umasep (boolean) - call flag to run code for specific time related</p>
<blockquote>
<div><p>to the UMASEP model</p>
</div></blockquote>
<dl class="simple">
<dt>str_thresh (string) - user-input thresholds in the format “30,1”</dt><dd><p>for &gt;30 MeV exceeds 1 pfu, “4-7,0.01” for 4-7 MeV differential
channel exceeds 0.01.  “30,1;4-7,0.01” multiple thresholds
separated by semi-colon.</p>
</dd>
<dt>nointerp (boolean) - set to true to fill in negative fluxes with None</dt><dd><p>value rather than filling in via linear interpolation in time</p>
</dd>
</dl>
<p>OUTPUTS:
sep_year (integer) - year of start of SEP event or year of beginning</p>
<blockquote>
<div><p>of user-input time period (if no threshold crossed)</p>
</div></blockquote>
<dl class="simple">
<dt>ep_month (integer) - month of start of SEP event or year of beginning</dt><dd><p>of user-input time period (if no threshold crossed)</p>
</dd>
<dt>sep_day (integer) - day of start of SEP event or year of beginning</dt><dd><p>of user-input time period (if no threshold crossed)</p>
</dd>
<dt>jsonfname (string) - name of saved json file (could include issue time,</dt><dd><p>which is the time that the program is run, so absolutely
need to pass file name back as argument)</p>
</dd>
</dl>
<p>and generates multiple plots</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.save_integral_fluxes_to_file">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">save_integral_fluxes_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_fluxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.save_integral_fluxes_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the time series of integral fluxes to a file. If the input
data set was in integral channels, then this file will contain exactly
the same values in the time series.
If the input data set was in differential energy bins, then this file
contains the estimated integral fluxes calculated in this program.</p>
<p>Writes out csv file with dates in first column and integral fluxes
for which a threshold was applied in the remaining columns. Writes
fluxes for full time period specified by user.
Any differential channels for which a threshold was applied are not
included in this file.</p>
<p>INPUTS:
experiment (string)
flux_type (string) - integral or differential
options (string array) - S14, Bruno2017, uncorrected options for GOES data
doBGSub (boolean) - indicates if background subtration is performed
model_name (string) - name of model or user experiment, if relevant
energy_thresholds (float 1xn array) - energy channels for which</p>
<blockquote>
<div><p>flux thresholds are applied</p>
</div></blockquote>
<dl class="simple">
<dt>crossing_time (datetime 1xn array) - start times of sep event for each</dt><dd><p>energy channel (energy_thresolds) for which a threshold was applied</p>
</dd>
</dl>
<p>dates (datetime 1xm array) - dates for flux time profile
integral_fluxes (float nxm array) - flux time profiles for each energy channel</p>
<blockquote>
<div><p>for which a threshold was applied; assumed to be (estimated)integral fluxes</p>
</div></blockquote>
<p>OUTPUTS:
No outputs except output file named e.g.</p>
<blockquote>
<div><p>integral_fluxes_GOES-13_differential_2012_3_7.csv</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.sort_bin_order">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">sort_bin_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.sort_bin_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the order of the energy bins. Usually, bins go from
low to high energies, but some modelers or users may
go in reverse order. Usually expect:
[[10,20],[20,30],[30,40]]
But user may instead input files with fluxes in order of:
[[30,40],[20,30],[10,20]]</p>
<p>This subroutine will reorder the fluxes and energy_bins
to go in increasing order. If differential fluxes were input,
this reordering will ensure that integral fluxes are
estimated properly.</p>
<p>INPUTS:
all_fluxes (float nxm array) - fluxes for n energy channels</p>
<blockquote>
<div><p>and m time points</p>
</div></blockquote>
<dl class="simple">
<dt>energy_bins (float 2xn array) - energy bins for each of the</dt><dd><p>energy channels</p>
</dd>
</dl>
<p>OUTPUTS:
sort_fluxes (float nxm array) - same as above, but sorted so</p>
<blockquote>
<div><p>that the lowest energy channel is first and highest is last</p>
</div></blockquote>
<p>sort_bins (float 2xn array) - same as above, but sorted</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.str_to_datetime">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">str_to_datetime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.str_to_datetime" title="Permalink to this definition">¶</a></dt>
<dd><p>String date to datetime
INPUTS:
date (string) - date as “YYYY-MM-DD” or “YYYY-MM-DD HH:MM:SS”</p>
<p>OUTPUTS:
dt (datetime) - datetime conversion of date</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.write_info_to_file">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">write_info_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experiment</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doBGSub</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spase_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">startdate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enddate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_thresholds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integral_fluxes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossing_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_peak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peak_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rise_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">event_end_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_threshold_fluences</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_fluence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_diff_thresh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep_times</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">umasep_fluxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.write_info_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write information to csv and json file.
Writes all of the derived information for all the
energy-threshold combinations to file.</p>
<p>INPUTS:
The inputs here are the same as the outputs produced by
append_differential_thresholds(). Please see the list
of those outputs for detailed explanations of these inputs.</p>
<p>OUTPUTS:
No outputs except files are written:</p>
<blockquote>
<div><dl class="simple">
<dt>-fluence spectra files for each energy channel for which a</dt><dd><p>threshold was applied</p>
</dd>
<dt>-integral fluxes in csv file for which a threshold was</dt><dd><p>applied</p>
</dd>
<dt>-flux time profiles in txt files for each energy channel for</dt><dd><p>which a threshold was applied</p>
</dd>
<dt>-json file in CCMC format containing blocks of information</dt><dd><p>for each energy channel for which a threshold was applied</p>
</dd>
</dl>
<p>-csv file containing all timing and peak flux values</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="operational_sep_quantities.write_zulu_time_profile">
<span class="sig-prename descclassname"><span class="pre">operational_sep_quantities.</span></span><span class="sig-name descname"><span class="pre">write_zulu_time_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fluxes</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#operational_sep_quantities.write_zulu_time_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Write out the time profile with the date in the
first column as the ISO standard and flux in the
second column as:
YYYY-MM-DDTHH:MM:SSZ    Float</p>
<p>INPUTS:
Filename (string) - name of file to write
date (datetime 1xn array) - list of dates
fluxes (float 1xn array) - corresponding fluxes</p>
<p>OUTPUTS:
None but writes output file with filename</p>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="run_multi_sep.html" class="btn btn-neutral float-right" title="run_multi_sep module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="compare_data_model.html" class="btn btn-neutral float-left" title="compare_data_model module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Kathryn Whitman.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>